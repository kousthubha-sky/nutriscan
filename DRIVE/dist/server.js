/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./app.js":
/*!****************!*\
  !*** ./app.js ***!
  \****************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar express = __webpack_require__(/*! express */ \"express\");\nvar cors = __webpack_require__(/*! cors */ \"cors\");\nvar path = __webpack_require__(/*! path */ \"path\");\n(__webpack_require__(/*! dotenv */ \"dotenv\").config)();\nvar cookieParser = __webpack_require__(/*! cookie-parser */ \"cookie-parser\");\nvar _require = __webpack_require__(/*! express-validator */ \"express-validator\"),\n  body = _require.body,\n  validationResult = _require.validationResult;\nvar fs = (__webpack_require__(/*! fs */ \"fs\").promises);\nvar helmet = __webpack_require__(/*! helmet */ \"helmet\");\nvar _require2 = __webpack_require__(/*! ./middleware/security */ \"./middleware/security.js\"),\n  xssPreventionMiddleware = _require2.xssPreventionMiddleware,\n  globalRateLimiter = _require2.globalRateLimiter,\n  apiRateLimiter = _require2.apiRateLimiter;\nvar app = express();\n\n// Security middleware\napp.use(helmet());\napp.use(xssPreventionMiddleware);\napp.use(globalRateLimiter);\napp.use('/api', apiRateLimiter);\n\n// Set security headers\napp.use(function (req, res, next) {\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  res.setHeader('X-Frame-Options', 'DENY');\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n  res.setHeader('Strict-Transport-Security', 'max-age=31536000; includeSubDomains');\n  next();\n});\n\n// Ensure uploads directory exists\nvar uploadsDir = path.join(__dirname, 'uploads', 'products');\n_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n  return _regeneratorRuntime().wrap(function _callee$(_context) {\n    while (1) switch (_context.prev = _context.next) {\n      case 0:\n        _context.prev = 0;\n        _context.next = 3;\n        return fs.access(uploadsDir);\n      case 3:\n        _context.next = 10;\n        break;\n      case 5:\n        _context.prev = 5;\n        _context.t0 = _context[\"catch\"](0);\n        _context.next = 9;\n        return fs.mkdir(uploadsDir, {\n          recursive: true\n        });\n      case 9:\n        console.log('Created uploads directory');\n      case 10:\n      case \"end\":\n        return _context.stop();\n    }\n  }, _callee, null, [[0, 5]]);\n}))()[\"catch\"](function (err) {\n  console.error('Failed to create uploads directory:', err);\n  process.exit(1);\n});\n\n// Configure CORS to allow all origins\napp.use(cors({\n  origin: true,\n  // Allow all origins\n  credentials: true\n}));\n\n// Database connection\nvar connecToDB = __webpack_require__(/*! ./config/db */ \"./config/db.js\");\nconnecToDB();\n\n// Middleware\napp.use(cookieParser());\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: true\n}));\n\n// Serve static files from uploads directory\napp.use('/uploads', express[\"static\"](path.join(__dirname, 'uploads')));\n\n// Error handling middleware for file uploads\napp.use(function (err, req, res, next) {\n  if (err.name === 'MulterError') {\n    return res.status(400).json({\n      success: false,\n      message: err.message\n    });\n  }\n  if (err) {\n    return res.status(500).json({\n      success: false,\n      message: 'Something went wrong with file upload'\n    });\n  }\n  next();\n});\n\n// Routes\nvar indexRouter = __webpack_require__(/*! ./routes/index.routes */ \"./routes/index.routes.js\");\nvar userRouter = __webpack_require__(/*! ./routes/user.routes */ \"./routes/user.routes.js\");\nvar adminRoutes = __webpack_require__(/*! ./routes/admin.routes */ \"./routes/admin.routes.js\");\nvar productRouter = __webpack_require__(/*! ./routes/productRoutes */ \"./routes/productRoutes.js\");\napp.use('/', indexRouter);\napp.use('/user', userRouter);\napp.use('/admin', adminRoutes);\napp.use('/products', productRouter);\n\n// Import error handling middleware\nvar _require3 = __webpack_require__(/*! ./middleware/errorMiddleware */ \"./middleware/errorMiddleware.js\"),\n  globalErrorHandler = _require3.globalErrorHandler,\n  setupErrorHandlers = _require3.setupErrorHandlers;\n\n// Global error handling middleware - must be after all routes\napp.use(globalErrorHandler);\n\n// Setup process-level error handlers\nsetupErrorHandlers(app);\nvar PORT = process.env.PORT || 3000;\nvar HOST = '0.0.0.0'; // Listen on all network interfaces\n\nvar server = app.listen(PORT, HOST, function () {\n  console.log(\"Server is running on http://\".concat(HOST, \":\").concat(PORT));\n});\n\n// Handle graceful shutdown\nprocess.on('SIGTERM', function () {\n  console.log('SIGTERM received. Shutting down gracefully...');\n  server.close(function () {\n    console.log('Server closed');\n    process.exit(0);\n  });\n});\n\n//# sourceURL=webpack://drive/./app.js?");

/***/ }),

/***/ "./config/db.js":
/*!**********************!*\
  !*** ./config/db.js ***!
  \**********************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("var mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nfunction connectToDB() {\n  mongoose.connect(process.env.MONGO_URI).then(function () {\n    console.log('connected to db');\n  });\n}\nmodule.exports = connectToDB;\n\n//# sourceURL=webpack://drive/./config/db.js?");

/***/ }),

/***/ "./config/email.js":
/*!*************************!*\
  !*** ./config/email.js ***!
  \*************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar nodemailer = __webpack_require__(/*! nodemailer */ \"nodemailer\");\n\n// Create a transporter using Gmail\nvar transporter = nodemailer.createTransport({\n  service: 'gmail',\n  auth: {\n    user: process.env.EMAIL_USER,\n    pass: process.env.EMAIL_PASS\n  }\n});\nvar sendEmail = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(to, subject, html) {\n    var mailOptions;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          mailOptions = {\n            from: process.env.EMAIL_USER,\n            to: to,\n            subject: subject,\n            html: html\n          };\n          _context.next = 4;\n          return transporter.sendMail(mailOptions);\n        case 4:\n          return _context.abrupt(\"return\", true);\n        case 7:\n          _context.prev = 7;\n          _context.t0 = _context[\"catch\"](0);\n          console.error('Email sending failed:', _context.t0);\n          return _context.abrupt(\"return\", false);\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 7]]);\n  }));\n  return function sendEmail(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\nmodule.exports = {\n  sendEmail: sendEmail\n};\n\n//# sourceURL=webpack://drive/./config/email.js?");

/***/ }),

/***/ "./controllers/adminController.js":
/*!****************************************!*\
  !*** ./controllers/adminController.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar ProductSubmission = __webpack_require__(/*! ../models/ProductSubmission */ \"./models/ProductSubmission.js\");\nvar Product = __webpack_require__(/*! ../models/Product */ \"./models/Product.js\");\nvar calculateHealthRating = __webpack_require__(/*! ../utils/healthRating */ \"./utils/healthRating.js\");\nvar User = __webpack_require__(/*! ../models/user.model */ \"./models/user.model.js\");\nvar fs = (__webpack_require__(/*! fs */ \"fs\").promises);\nvar path = __webpack_require__(/*! path */ \"path\");\n\n// Helper function to delete uploaded files\nfunction cleanupFiles(_x) {\n  return _cleanupFiles.apply(this, arguments);\n} // Middleware to check if user is admin\nfunction _cleanupFiles() {\n  _cleanupFiles = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12(submission) {\n    return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n      while (1) switch (_context12.prev = _context12.next) {\n        case 0:\n          _context12.prev = 0;\n          if (!submission.productImage) {\n            _context12.next = 4;\n            break;\n          }\n          _context12.next = 4;\n          return fs.unlink(submission.productImage);\n        case 4:\n          if (!submission.barcodeImage) {\n            _context12.next = 7;\n            break;\n          }\n          _context12.next = 7;\n          return fs.unlink(submission.barcodeImage);\n        case 7:\n          _context12.next = 12;\n          break;\n        case 9:\n          _context12.prev = 9;\n          _context12.t0 = _context12[\"catch\"](0);\n          console.error('Error cleaning up files:', _context12.t0);\n        case 12:\n        case \"end\":\n          return _context12.stop();\n      }\n    }, _callee12, null, [[0, 9]]);\n  }));\n  return _cleanupFiles.apply(this, arguments);\n}\nexports.isAdmin = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(req, res, next) {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (req.user) {\n            _context.next = 2;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            success: false,\n            message: 'Authentication required'\n          }));\n        case 2:\n          if (!(req.user.role !== 'admin')) {\n            _context.next = 4;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(403).json({\n            success: false,\n            message: 'Access denied. Admin only.'\n          }));\n        case 4:\n          next();\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function (_x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n// Get all pending submissions\nexports.getPendingSubmissions = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(req, res) {\n    var page, limit, skip, submissions, total;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          page = parseInt(req.query.page) || 1;\n          limit = parseInt(req.query.limit) || 10;\n          skip = (page - 1) * limit;\n          _context2.next = 6;\n          return ProductSubmission.find({\n            status: 'pending'\n          }).populate('submittedBy', 'username email').sort({\n            submittedAt: -1\n          }).skip(skip).limit(limit).lean();\n        case 6:\n          submissions = _context2.sent;\n          _context2.next = 9;\n          return ProductSubmission.countDocuments({\n            status: 'pending'\n          });\n        case 9:\n          total = _context2.sent;\n          res.json({\n            success: true,\n            submissions: submissions,\n            currentPage: page,\n            totalPages: Math.ceil(total / limit),\n            total: total\n          });\n          _context2.next = 17;\n          break;\n        case 13:\n          _context2.prev = 13;\n          _context2.t0 = _context2[\"catch\"](0);\n          console.error('Error fetching submissions:', _context2.t0);\n          res.status(500).json({\n            success: false,\n            message: 'Failed to fetch submissions'\n          });\n        case 17:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2, null, [[0, 13]]);\n  }));\n  return function (_x5, _x6) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\n// Get submission details\nexports.getSubmissionDetails = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(req, res) {\n    var submission;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          _context3.next = 3;\n          return ProductSubmission.findById(req.params.id).populate('submittedBy', 'username email').populate('reviewedBy', 'username').lean();\n        case 3:\n          submission = _context3.sent;\n          if (submission) {\n            _context3.next = 6;\n            break;\n          }\n          return _context3.abrupt(\"return\", res.status(404).json({\n            success: false,\n            message: 'Submission not found'\n          }));\n        case 6:\n          res.json({\n            success: true,\n            submission: submission\n          });\n          _context3.next = 13;\n          break;\n        case 9:\n          _context3.prev = 9;\n          _context3.t0 = _context3[\"catch\"](0);\n          console.error('Error fetching submission:', _context3.t0);\n          res.status(500).json({\n            success: false,\n            message: 'Failed to fetch submission details'\n          });\n        case 13:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 9]]);\n  }));\n  return function (_x7, _x8) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\n// Review submission (approve/reject)\nexports.reviewSubmission = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(req, res) {\n    var id, _req$body, status, adminNotes, productName, brand, category, ingredients, nutritionalInfo, allergens, dietaryInfo, submission, nutriments, healthAnalysis, newProduct;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.prev = 0;\n          id = req.params.id;\n          _req$body = req.body, status = _req$body.status, adminNotes = _req$body.adminNotes, productName = _req$body.productName, brand = _req$body.brand, category = _req$body.category, ingredients = _req$body.ingredients, nutritionalInfo = _req$body.nutritionalInfo, allergens = _req$body.allergens, dietaryInfo = _req$body.dietaryInfo; // Validate required fields\n          if (status) {\n            _context4.next = 5;\n            break;\n          }\n          return _context4.abrupt(\"return\", res.status(400).json({\n            success: false,\n            message: 'Status is required for review submission'\n          }));\n        case 5:\n          _context4.next = 7;\n          return ProductSubmission.findById(id);\n        case 7:\n          submission = _context4.sent;\n          if (submission) {\n            _context4.next = 10;\n            break;\n          }\n          return _context4.abrupt(\"return\", res.status(404).json({\n            success: false,\n            message: 'Submission not found'\n          }));\n        case 10:\n          if (['pending', 'in_review', 'approved', 'rejected'].includes(status)) {\n            _context4.next = 12;\n            break;\n          }\n          return _context4.abrupt(\"return\", res.status(400).json({\n            success: false,\n            message: 'Invalid status value'\n          }));\n        case 12:\n          // Update submission fields if provided\n          if (productName) submission.productName = productName;\n          if (brand) submission.brand = brand;\n          if (category) submission.category = category;\n          if (ingredients) submission.ingredients = ingredients;\n          if (nutritionalInfo) submission.nutritionalInfo = nutritionalInfo;\n          if (allergens) submission.allergens = allergens;\n          if (dietaryInfo) submission.dietaryInfo = dietaryInfo;\n\n          // Update status and add to review history\n          submission.status = status;\n          submission.adminNotes = adminNotes;\n          submission.reviewHistory.push({\n            status: status,\n            notes: adminNotes,\n            updatedBy: req.user._id\n          });\n\n          // If approved, create a new product in the main products collection\n          if (!(status === 'approved')) {\n            _context4.next = 35;\n            break;\n          }\n          _context4.prev = 23;\n          // Map nutritional info to product schema format\n          nutriments = {\n            energy_kcal_100g: (nutritionalInfo === null || nutritionalInfo === void 0 ? void 0 : nutritionalInfo.calories) || 0,\n            carbohydrates_100g: (nutritionalInfo === null || nutritionalInfo === void 0 ? void 0 : nutritionalInfo.carbohydrates) || 0,\n            sugars_100g: (nutritionalInfo === null || nutritionalInfo === void 0 ? void 0 : nutritionalInfo.sugar) || 0,\n            fat_100g: (nutritionalInfo === null || nutritionalInfo === void 0 ? void 0 : nutritionalInfo.fat) || 0,\n            proteins_100g: (nutritionalInfo === null || nutritionalInfo === void 0 ? void 0 : nutritionalInfo.protein) || 0,\n            fiber_100g: (nutritionalInfo === null || nutritionalInfo === void 0 ? void 0 : nutritionalInfo.fiber) || 0\n          }; // Calculate health rating based on nutritional info\n          healthAnalysis = calculateHealthRating({\n            ingredients: Array.isArray(ingredients) ? ingredients.join(', ') : '',\n            nutriments: nutriments,\n            nutriscore_grade: 'unknown'\n          });\n          newProduct = new Product({\n            name: submission.productName,\n            barcode: submission.barcodeNumber,\n            brand: submission.brand,\n            category: submission.category,\n            ingredients: Array.isArray(submission.ingredients) ? submission.ingredients : [submission.ingredients].filter(Boolean),\n            nutriments: nutriments,\n            allergens: Array.isArray(submission.allergens) ? submission.allergens : [submission.allergens].filter(Boolean),\n            labels: submission.dietaryInfo ? submission.dietaryInfo.join(', ') : '',\n            productImage: submission.productImage,\n            barcodeImage: submission.barcodeImage,\n            addedBy: submission.submittedBy,\n            lastFetched: new Date(),\n            healthRating: healthAnalysis.score,\n            healthAnalysis: healthAnalysis.analysis,\n            healthRatingLabel: healthAnalysis.rating,\n            healthRatingColor: healthAnalysis.color\n          });\n          _context4.next = 29;\n          return newProduct.save();\n        case 29:\n          _context4.next = 35;\n          break;\n        case 31:\n          _context4.prev = 31;\n          _context4.t0 = _context4[\"catch\"](23);\n          console.error('Error creating product:', _context4.t0);\n          return _context4.abrupt(\"return\", res.status(500).json({\n            success: false,\n            message: 'Failed to create product from submission',\n            error: _context4.t0.message\n          }));\n        case 35:\n          _context4.next = 37;\n          return submission.save();\n        case 37:\n          res.json({\n            success: true,\n            message: 'Submission reviewed successfully',\n            submission: submission\n          });\n          _context4.next = 44;\n          break;\n        case 40:\n          _context4.prev = 40;\n          _context4.t1 = _context4[\"catch\"](0);\n          console.error('Review submission error:', _context4.t1);\n          res.status(500).json({\n            success: false,\n            message: 'Error processing review submission',\n            error: _context4.t1.message\n          });\n        case 44:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4, null, [[0, 40], [23, 31]]);\n  }));\n  return function (_x9, _x0) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\n// Get submission statistics\nexports.getSubmissionStats = /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(req, res) {\n    var stats, formattedStats;\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.prev = 0;\n          _context5.next = 3;\n          return ProductSubmission.aggregate([{\n            $group: {\n              _id: '$status',\n              count: {\n                $sum: 1\n              }\n            }\n          }]);\n        case 3:\n          stats = _context5.sent;\n          formattedStats = stats.reduce(function (acc, stat) {\n            acc[stat._id] = stat.count;\n            return acc;\n          }, {\n            pending: 0,\n            approved: 0,\n            rejected: 0\n          });\n          res.json({\n            success: true,\n            stats: formattedStats\n          });\n          _context5.next = 12;\n          break;\n        case 8:\n          _context5.prev = 8;\n          _context5.t0 = _context5[\"catch\"](0);\n          console.error('Error fetching stats:', _context5.t0);\n          res.status(500).json({\n            success: false,\n            message: 'Failed to fetch statistics'\n          });\n        case 12:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee5, null, [[0, 8]]);\n  }));\n  return function (_x1, _x10) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\n// Get admin dashboard statistics\nexports.getStats = /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(req, res) {\n    var totalUsers, activeUsers, totalProducts, pendingSubmissions;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.prev = 0;\n          _context6.next = 3;\n          return User.countDocuments();\n        case 3:\n          totalUsers = _context6.sent;\n          _context6.next = 6;\n          return User.countDocuments({\n            status: 'active'\n          });\n        case 6:\n          activeUsers = _context6.sent;\n          _context6.next = 9;\n          return Product.countDocuments();\n        case 9:\n          totalProducts = _context6.sent;\n          _context6.next = 12;\n          return ProductSubmission.countDocuments({\n            status: 'pending'\n          });\n        case 12:\n          pendingSubmissions = _context6.sent;\n          res.json({\n            totalUsers: totalUsers,\n            activeUsers: activeUsers,\n            totalProducts: totalProducts,\n            pendingSubmissions: pendingSubmissions\n          });\n          _context6.next = 19;\n          break;\n        case 16:\n          _context6.prev = 16;\n          _context6.t0 = _context6[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error fetching stats',\n            error: _context6.t0.message\n          });\n        case 19:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6, null, [[0, 16]]);\n  }));\n  return function (_x11, _x12) {\n    return _ref6.apply(this, arguments);\n  };\n}();\n\n// Get all products\nexports.getProducts = /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(req, res) {\n    var products;\n    return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n      while (1) switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.prev = 0;\n          _context7.next = 3;\n          return Product.find().sort({\n            createdAt: -1\n          }).populate('addedBy', 'username');\n        case 3:\n          products = _context7.sent;\n          res.json(products);\n          _context7.next = 10;\n          break;\n        case 7:\n          _context7.prev = 7;\n          _context7.t0 = _context7[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error fetching products',\n            error: _context7.t0.message\n          });\n        case 10:\n        case \"end\":\n          return _context7.stop();\n      }\n    }, _callee7, null, [[0, 7]]);\n  }));\n  return function (_x13, _x14) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\n// Get all product submissions\nexports.getSubmissions = /*#__PURE__*/function () {\n  var _ref8 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(req, res) {\n    var submissions;\n    return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n      while (1) switch (_context8.prev = _context8.next) {\n        case 0:\n          _context8.prev = 0;\n          _context8.next = 3;\n          return ProductSubmission.find().populate('submittedBy', 'username email').sort({\n            submittedAt: -1\n          });\n        case 3:\n          submissions = _context8.sent;\n          res.json(submissions);\n          _context8.next = 10;\n          break;\n        case 7:\n          _context8.prev = 7;\n          _context8.t0 = _context8[\"catch\"](0);\n          res.status(500).json({\n            message: _context8.t0.message\n          });\n        case 10:\n        case \"end\":\n          return _context8.stop();\n      }\n    }, _callee8, null, [[0, 7]]);\n  }));\n  return function (_x15, _x16) {\n    return _ref8.apply(this, arguments);\n  };\n}();\n\n// Get submission by ID\nexports.getSubmissionById = /*#__PURE__*/function () {\n  var _ref9 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(req, res) {\n    var submission;\n    return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n      while (1) switch (_context9.prev = _context9.next) {\n        case 0:\n          _context9.prev = 0;\n          _context9.next = 3;\n          return ProductSubmission.findById(req.params.id).populate('submittedBy', 'username email').populate('reviewHistory.updatedBy', 'username');\n        case 3:\n          submission = _context9.sent;\n          if (submission) {\n            _context9.next = 6;\n            break;\n          }\n          return _context9.abrupt(\"return\", res.status(404).json({\n            message: 'Submission not found'\n          }));\n        case 6:\n          res.json(submission);\n          _context9.next = 12;\n          break;\n        case 9:\n          _context9.prev = 9;\n          _context9.t0 = _context9[\"catch\"](0);\n          res.status(500).json({\n            message: _context9.t0.message\n          });\n        case 12:\n        case \"end\":\n          return _context9.stop();\n      }\n    }, _callee9, null, [[0, 9]]);\n  }));\n  return function (_x17, _x18) {\n    return _ref9.apply(this, arguments);\n  };\n}();\n\n// Get all users\nexports.getUsers = /*#__PURE__*/function () {\n  var _ref0 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee0(req, res) {\n    var users;\n    return _regeneratorRuntime().wrap(function _callee0$(_context0) {\n      while (1) switch (_context0.prev = _context0.next) {\n        case 0:\n          _context0.prev = 0;\n          _context0.next = 3;\n          return User.find().sort({\n            createdAt: -1\n          }).select('-password');\n        case 3:\n          users = _context0.sent;\n          res.json(users);\n          _context0.next = 10;\n          break;\n        case 7:\n          _context0.prev = 7;\n          _context0.t0 = _context0[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error fetching users',\n            error: _context0.t0.message\n          });\n        case 10:\n        case \"end\":\n          return _context0.stop();\n      }\n    }, _callee0, null, [[0, 7]]);\n  }));\n  return function (_x19, _x20) {\n    return _ref0.apply(this, arguments);\n  };\n}();\n\n// Update submission status\nexports.updateSubmissionStatus = /*#__PURE__*/function () {\n  var _ref1 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee1(req, res) {\n    var id, status, submission;\n    return _regeneratorRuntime().wrap(function _callee1$(_context1) {\n      while (1) switch (_context1.prev = _context1.next) {\n        case 0:\n          _context1.prev = 0;\n          id = req.params.id;\n          status = req.body.status;\n          _context1.next = 5;\n          return ProductSubmission.findById(id);\n        case 5:\n          submission = _context1.sent;\n          if (submission) {\n            _context1.next = 8;\n            break;\n          }\n          return _context1.abrupt(\"return\", res.status(404).json({\n            message: 'Submission not found'\n          }));\n        case 8:\n          submission.status = status;\n          _context1.next = 11;\n          return submission.save();\n        case 11:\n          res.json({\n            message: 'Status updated successfully',\n            submission: submission\n          });\n          _context1.next = 17;\n          break;\n        case 14:\n          _context1.prev = 14;\n          _context1.t0 = _context1[\"catch\"](0);\n          res.status(500).json({\n            message: _context1.t0.message\n          });\n        case 17:\n        case \"end\":\n          return _context1.stop();\n      }\n    }, _callee1, null, [[0, 14]]);\n  }));\n  return function (_x21, _x22) {\n    return _ref1.apply(this, arguments);\n  };\n}();\n\n// Update product status\nexports.updateProductStatus = /*#__PURE__*/function () {\n  var _ref10 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(req, res) {\n    var id, status, product;\n    return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n      while (1) switch (_context10.prev = _context10.next) {\n        case 0:\n          _context10.prev = 0;\n          id = req.params.id;\n          status = req.body.status;\n          _context10.next = 5;\n          return Product.findByIdAndUpdate(id, {\n            status: status\n          }, {\n            \"new\": true\n          });\n        case 5:\n          product = _context10.sent;\n          if (product) {\n            _context10.next = 8;\n            break;\n          }\n          return _context10.abrupt(\"return\", res.status(404).json({\n            message: 'Product not found'\n          }));\n        case 8:\n          res.json(product);\n          _context10.next = 14;\n          break;\n        case 11:\n          _context10.prev = 11;\n          _context10.t0 = _context10[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error updating product',\n            error: _context10.t0.message\n          });\n        case 14:\n        case \"end\":\n          return _context10.stop();\n      }\n    }, _callee10, null, [[0, 11]]);\n  }));\n  return function (_x23, _x24) {\n    return _ref10.apply(this, arguments);\n  };\n}();\n\n// Update user status\nexports.updateUserStatus = /*#__PURE__*/function () {\n  var _ref11 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(req, res) {\n    var id, status, user;\n    return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n      while (1) switch (_context11.prev = _context11.next) {\n        case 0:\n          _context11.prev = 0;\n          id = req.params.id;\n          status = req.body.status;\n          _context11.next = 5;\n          return User.findByIdAndUpdate(id, {\n            status: status\n          }, {\n            \"new\": true\n          }).select('-password');\n        case 5:\n          user = _context11.sent;\n          if (user) {\n            _context11.next = 8;\n            break;\n          }\n          return _context11.abrupt(\"return\", res.status(404).json({\n            message: 'User not found'\n          }));\n        case 8:\n          res.json(user);\n          _context11.next = 14;\n          break;\n        case 11:\n          _context11.prev = 11;\n          _context11.t0 = _context11[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error updating user',\n            error: _context11.t0.message\n          });\n        case 14:\n        case \"end\":\n          return _context11.stop();\n      }\n    }, _callee11, null, [[0, 11]]);\n  }));\n  return function (_x25, _x26) {\n    return _ref11.apply(this, arguments);\n  };\n}();\n\n//# sourceURL=webpack://drive/./controllers/adminController.js?");

/***/ }),

/***/ "./controllers/productController.js":
/*!******************************************!*\
  !*** ./controllers/productController.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("function _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar axios = __webpack_require__(/*! axios */ \"axios\");\nvar mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nvar Product = __webpack_require__(/*! ../models/Product */ \"./models/Product.js\");\nvar calculateHealthRating = __webpack_require__(/*! ../utils/healthRating */ \"./utils/healthRating.js\");\nvar healthRatingCache = (__webpack_require__(/*! ../utils/cacheService */ \"./utils/cacheService.js\").HealthRatingCache);\n\n// Create an axios instance with custom config\nvar api = axios.create({\n  timeout: 10000,\n  // 10 second timeout\n  retry: 2,\n  retryDelay: 1000\n});\n\n// Add a retry interceptor\napi.interceptors.response.use(undefined, /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(err) {\n    var config;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          config = err.config;\n          if (!(!config || !config.retry)) {\n            _context.next = 3;\n            break;\n          }\n          return _context.abrupt(\"return\", Promise.reject(err));\n        case 3:\n          config.retry -= 1;\n          if (!(config.retry === 0)) {\n            _context.next = 6;\n            break;\n          }\n          return _context.abrupt(\"return\", Promise.reject(err));\n        case 6:\n          _context.next = 8;\n          return new Promise(function (resolve) {\n            return setTimeout(resolve, config.retryDelay);\n          });\n        case 8:\n          return _context.abrupt(\"return\", api.request(config));\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}());\nfunction escapeRegExp(string) {\n  if (!string) return '';\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n}\nexports.searchProducts = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(req, res) {\n    var limit, _req$query, query, _req$query$page, page, _req$query$filters, filters, _req$query$sortBy, sortBy, skip, sanitizedQuery, searchQuery, dietaryFilters, _searchQuery$$and, priceQuery, sortOptions, _yield$Promise$all, _yield$Promise$all2, localResults, totalCount, productIds, apiProducts, apiResponse, bulkOps, combinedProducts, sortedProducts, totalPages;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          limit = 10;\n          _context2.prev = 1;\n          _req$query = req.query, query = _req$query.q, _req$query$page = _req$query.page, page = _req$query$page === void 0 ? 1 : _req$query$page, _req$query$filters = _req$query.filters, filters = _req$query$filters === void 0 ? {} : _req$query$filters, _req$query$sortBy = _req$query.sortBy, sortBy = _req$query$sortBy === void 0 ? 'relevance' : _req$query$sortBy;\n          console.log('Search request:', {\n            query: query,\n            page: page,\n            sortBy: sortBy,\n            filters: filters\n          });\n\n          // Relaxed validation - allow minimum 1 character\n          if (!(!query || typeof query !== 'string' || query.trim().length === 0)) {\n            _context2.next = 6;\n            break;\n          }\n          return _context2.abrupt(\"return\", res.status(400).json({\n            success: false,\n            error: 'Please enter a valid search term'\n          }));\n        case 6:\n          skip = (parseInt(page) - 1) * parseInt(limit);\n          sanitizedQuery = escapeRegExp(query.trim()); // Build base search query\n          searchQuery = {\n            $or: [{\n              name: new RegExp(sanitizedQuery, 'i')\n            }, {\n              brand: new RegExp(sanitizedQuery, 'i')\n            }, {\n              category: new RegExp(sanitizedQuery, 'i')\n            }, {\n              barcode: new RegExp(sanitizedQuery, 'i')\n            }]\n          }; // Apply filters if provided\n          if (!(_typeof(filters) === 'object')) {\n            _context2.next = 28;\n            break;\n          }\n          if (filters.brand) {\n            searchQuery.brand = new RegExp(filters.brand, 'i');\n          }\n          if (filters.category && filters.category !== 'all') {\n            searchQuery.category = new RegExp(filters.category, 'i');\n          }\n          if (filters.healthRating > 0) {\n            searchQuery.healthRating = {\n              $gte: parseFloat(filters.healthRating)\n            };\n          }\n\n          // Handle filter chips (dietary preferences)\n          if (filters.dietary && Array.isArray(filters.dietary)) {\n            dietaryFilters = filters.dietary.map(function (pref) {\n              switch (pref) {\n                case 'gluten-free':\n                  return {\n                    ingredients: {\n                      $not: /wheat|gluten/i\n                    }\n                  };\n                case 'no preservatives':\n                  return {\n                    ingredients: {\n                      $not: /preservative|sulfite|nitrite|bha|bht/i\n                    }\n                  };\n                case 'vegan':\n                  return {\n                    ingredients: {\n                      $not: /meat|milk|egg|honey|gelatin/i\n                    }\n                  };\n                case 'organic':\n                  return {\n                    $or: [{\n                      labels: /organic/i\n                    }, {\n                      name: /organic/i\n                    }]\n                  };\n                case 'low sugar':\n                  return {\n                    'nutriments.sugars_100g': {\n                      $lt: 5\n                    }\n                  };\n                case 'high protein':\n                  return {\n                    'nutriments.proteins_100g': {\n                      $gt: 10\n                    }\n                  };\n                case 'no artificial colors':\n                  return {\n                    ingredients: {\n                      $not: /artificial color|food coloring|red 40|yellow 5|blue 1/i\n                    }\n                  };\n                case 'whole grain':\n                  return {\n                    ingredients: /whole grain|whole wheat|whole oat/i\n                  };\n                case 'dairy-free':\n                  return {\n                    ingredients: {\n                      $not: /milk|cream|cheese|yogurt|butter/i\n                    }\n                  };\n                case 'low fat':\n                  return {\n                    'nutriments.fat_100g': {\n                      $lt: 3\n                    }\n                  };\n                default:\n                  return {};\n              }\n            });\n            if (dietaryFilters.length > 0) {\n              searchQuery.$and = searchQuery.$and || [];\n              (_searchQuery$$and = searchQuery.$and).push.apply(_searchQuery$$and, _toConsumableArray(dietaryFilters));\n            }\n          }\n          if (!filters.price) {\n            _context2.next = 27;\n            break;\n          }\n          priceQuery = {};\n          _context2.t0 = filters.price;\n          _context2.next = _context2.t0 === 'budget' ? 19 : _context2.t0 === 'mid' ? 21 : _context2.t0 === 'premium' ? 24 : 26;\n          break;\n        case 19:\n          priceQuery.$lte = 50;\n          return _context2.abrupt(\"break\", 26);\n        case 21:\n          priceQuery.$gt = 50;\n          priceQuery.$lte = 200;\n          return _context2.abrupt(\"break\", 26);\n        case 24:\n          priceQuery.$gt = 200;\n          return _context2.abrupt(\"break\", 26);\n        case 26:\n          if (Object.keys(priceQuery).length > 0) {\n            searchQuery.price = priceQuery;\n          }\n        case 27:\n          if (filters.certification) {\n            searchQuery.labels = new RegExp(filters.certification, 'i');\n          }\n        case 28:\n          // Determine sort order\n          sortOptions = {\n            searchCount: -1,\n            lastFetched: -1\n          };\n          _context2.t1 = sortBy;\n          _context2.next = _context2.t1 === 'health' ? 32 : _context2.t1 === 'popularity' ? 34 : _context2.t1 === 'price-low' ? 36 : _context2.t1 === 'price-high' ? 38 : 40;\n          break;\n        case 32:\n          sortOptions = _objectSpread({\n            healthRating: -1\n          }, sortOptions);\n          return _context2.abrupt(\"break\", 41);\n        case 34:\n          sortOptions = {\n            searchCount: -1,\n            healthRating: -1\n          };\n          return _context2.abrupt(\"break\", 41);\n        case 36:\n          sortOptions = _objectSpread({\n            price: 1\n          }, sortOptions);\n          return _context2.abrupt(\"break\", 41);\n        case 38:\n          sortOptions = _objectSpread({\n            price: -1\n          }, sortOptions);\n          return _context2.abrupt(\"break\", 41);\n        case 40:\n          return _context2.abrupt(\"break\", 41);\n        case 41:\n          _context2.next = 43;\n          return Promise.all([Product.find(searchQuery).sort(sortOptions).skip(skip).limit(limit).lean(), Product.countDocuments(searchQuery)]);\n        case 43:\n          _yield$Promise$all = _context2.sent;\n          _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n          localResults = _yield$Promise$all2[0];\n          totalCount = _yield$Promise$all2[1];\n          if (!(localResults.length > 0)) {\n            _context2.next = 51;\n            break;\n          }\n          productIds = localResults.map(function (p) {\n            return p._id;\n          });\n          _context2.next = 51;\n          return Product.updateMany({\n            _id: {\n              $in: productIds\n            }\n          }, {\n            $inc: {\n              searchCount: 1\n            }\n          });\n        case 51:\n          // Only fetch from API if local results are insufficient\n          apiProducts = [];\n          if (!(localResults.length < limit)) {\n            _context2.next = 73;\n            break;\n          }\n          _context2.prev = 53;\n          _context2.next = 56;\n          return api.get('https://world.openfoodfacts.org/cgi/search.pl', {\n            params: {\n              search_terms: sanitizedQuery,\n              page_size: limit - localResults.length,\n              page: 1,\n              json: 1\n            }\n          });\n        case 56:\n          apiResponse = _context2.sent;\n          apiProducts = (apiResponse.data.products || []).filter(function (p) {\n            return !localResults.some(function (local) {\n              return local.barcode === p.code;\n            });\n          }).map(function (p) {\n            var _p$categories, _p$nutriments, _p$nutriments2, _p$nutriments3, _p$nutriments4, _p$nutriments5, _p$nutriments6, _p$nutriments7, _p$nutriments8;\n            var healthAnalysis = calculateHealthRating({\n              ingredients: p.ingredients_text || '',\n              nutriments: p.nutriments,\n              nutriscore_grade: p.nutriscore_grade\n            });\n            return {\n              barcode: p.code,\n              name: p.product_name || 'Unknown Product',\n              brand: p.brands || 'Unknown Brand',\n              imageUrl: p.image_url || p.image_small_url || p.image_thumb_url,\n              category: (_p$categories = p.categories) === null || _p$categories === void 0 || (_p$categories = _p$categories.split(',')[0]) === null || _p$categories === void 0 ? void 0 : _p$categories.trim(),\n              description: p.generic_name || p.product_name,\n              genericName: p.generic_name,\n              ingredients: p.ingredients_text ? p.ingredients_text.split(',').map(function (i) {\n                return i.trim();\n              }).filter(Boolean) : [],\n              labels: p.labels || '',\n              allergens: p.allergens ? p.allergens.split(',').map(function (a) {\n                return a.trim();\n              }).filter(Boolean) : [],\n              nutriments: {\n                energy_kcal_100g: (_p$nutriments = p.nutriments) === null || _p$nutriments === void 0 ? void 0 : _p$nutriments.energy_kcal_100g,\n                carbohydrates_100g: (_p$nutriments2 = p.nutriments) === null || _p$nutriments2 === void 0 ? void 0 : _p$nutriments2.carbohydrates_100g,\n                sugars_100g: (_p$nutriments3 = p.nutriments) === null || _p$nutriments3 === void 0 ? void 0 : _p$nutriments3.sugars_100g,\n                fat_100g: (_p$nutriments4 = p.nutriments) === null || _p$nutriments4 === void 0 ? void 0 : _p$nutriments4.fat_100g,\n                saturated_fat_100g: (_p$nutriments5 = p.nutriments) === null || _p$nutriments5 === void 0 ? void 0 : _p$nutriments5.saturated_fat_100g,\n                proteins_100g: (_p$nutriments6 = p.nutriments) === null || _p$nutriments6 === void 0 ? void 0 : _p$nutriments6.proteins_100g,\n                fiber_100g: (_p$nutriments7 = p.nutriments) === null || _p$nutriments7 === void 0 ? void 0 : _p$nutriments7.fiber_100g,\n                salt_100g: (_p$nutriments8 = p.nutriments) === null || _p$nutriments8 === void 0 ? void 0 : _p$nutriments8.salt_100g\n              },\n              nutriscore_grade: p.nutriscore_grade,\n              healthRating: healthAnalysis.score,\n              healthAnalysis: healthAnalysis.analysis,\n              healthRatingLabel: healthAnalysis.rating,\n              healthRatingColor: healthAnalysis.color,\n              source: 'api',\n              lastFetched: new Date()\n            };\n          });\n\n          // Store new API products in background\n          if (!(apiProducts.length > 0)) {\n            _context2.next = 68;\n            break;\n          }\n          bulkOps = apiProducts.map(function (product) {\n            return {\n              updateOne: {\n                filter: {\n                  barcode: product.barcode\n                },\n                update: {\n                  $set: _objectSpread({}, product)\n                },\n                upsert: true\n              }\n            };\n          });\n          _context2.prev = 60;\n          _context2.next = 63;\n          return Product.bulkWrite(bulkOps);\n        case 63:\n          _context2.next = 68;\n          break;\n        case 65:\n          _context2.prev = 65;\n          _context2.t2 = _context2[\"catch\"](60);\n          console.error('Error storing products:', _context2.t2);\n        case 68:\n          _context2.next = 73;\n          break;\n        case 70:\n          _context2.prev = 70;\n          _context2.t3 = _context2[\"catch\"](53);\n          console.error('API fetch error:', _context2.t3);\n        case 73:\n          // Combine and sort all results\n          combinedProducts = [].concat(_toConsumableArray(localResults), _toConsumableArray(apiProducts)).slice(0, limit); // Sort combined results based on filters\n          sortedProducts = combinedProducts.sort(function (a, b) {\n            switch (sortBy) {\n              case 'health':\n                return b.healthRating - a.healthRating;\n              case 'popularity':\n                return b.searchCount - a.searchCount;\n              case 'price-low':\n                return (a.price || 0) - (b.price || 0);\n              case 'price-high':\n                return (b.price || 0) - (a.price || 0);\n              default:\n                return b.searchCount - a.searchCount;\n            }\n          }); // Calculate pagination\n          totalPages = Math.ceil(Math.max(totalCount, localResults.length + apiProducts.length) / limit);\n          res.json({\n            success: true,\n            products: sortedProducts,\n            currentPage: parseInt(page),\n            totalPages: totalPages,\n            total: totalCount,\n            sources: {\n              local: localResults.length,\n              api: apiProducts.length\n            }\n          });\n          _context2.next = 83;\n          break;\n        case 79:\n          _context2.prev = 79;\n          _context2.t4 = _context2[\"catch\"](1);\n          console.error('Search error:', _context2.t4);\n          res.status(500).json({\n            success: false,\n            error: 'Search failed',\n            details: _context2.t4.message\n          });\n        case 83:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2, null, [[1, 79], [53, 70], [60, 65]]);\n  }));\n  return function (_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexports.getFeaturedProducts = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(req, res) {\n    var categories, results;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          categories = ['oats', 'nuts', 'yogurt', 'fruits', 'vegetables'];\n          _context3.next = 4;\n          return Product.find({\n            $or: [{\n              category: {\n                $in: categories.map(function (cat) {\n                  return new RegExp(cat, 'i');\n                })\n              }\n            }, {\n              healthRating: {\n                $gte: 3.0\n              }\n            }]\n          }).sort({\n            healthRating: -1,\n            searchCount: -1\n          }).limit(12).lean();\n        case 4:\n          results = _context3.sent;\n          res.json({\n            success: true,\n            products: results\n          });\n          _context3.next = 12;\n          break;\n        case 8:\n          _context3.prev = 8;\n          _context3.t0 = _context3[\"catch\"](0);\n          console.error('Failed to fetch featured products:', _context3.t0);\n          res.status(500).json({\n            success: false,\n            error: 'Failed to fetch featured products'\n          });\n        case 12:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 8]]);\n  }));\n  return function (_x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexports.getHealthierAlternatives = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(req, res) {\n    var _req$query2, category, _req$query2$healthRat, healthRating, productData, cacheKey, cachedAlternatives, minHealthRating, mainQuery, categoryTerms, categoryPatterns, nutrientRanges, NUTRIENT_TOLERANCE, alternatives, broadQuery, broadAlternatives, _results, results;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.prev = 0;\n          _req$query2 = req.query, category = _req$query2.category, _req$query2$healthRat = _req$query2.healthRating, healthRating = _req$query2$healthRat === void 0 ? 3.0 : _req$query2$healthRat;\n          productData = req.body;\n          if (productData) {\n            _context4.next = 5;\n            break;\n          }\n          return _context4.abrupt(\"return\", res.status(400).json({\n            success: false,\n            error: 'Missing product data'\n          }));\n        case 5:\n          // Generate cache key for alternatives query\n          cacheKey = \"alternatives:\".concat(category, \":\").concat(healthRating, \":\").concat(productData._id);\n          cachedAlternatives = healthRatingCache.get({\n            _id: cacheKey\n          });\n          if (!cachedAlternatives) {\n            _context4.next = 9;\n            break;\n          }\n          return _context4.abrupt(\"return\", res.json({\n            success: true,\n            alternatives: cachedAlternatives,\n            fromCache: true\n          }));\n        case 9:\n          // Rest of the existing getHealthierAlternatives logic...\n          minHealthRating = parseFloat(healthRating); // Build base query\n          mainQuery = {\n            healthRating: {\n              $gt: Math.max(minHealthRating, productData.healthRating || 3.0)\n            }\n          }; // Add ID exclusion if provided\n          if (productData._id) {\n            try {\n              mainQuery._id = {\n                $ne: new mongoose.Types.ObjectId(productData._id)\n              };\n            } catch (error) {\n              console.warn('Invalid ObjectId for product exclusion:', productData._id);\n            }\n          }\n\n          // Add category matching if available\n          if (category && category !== 'All Categories') {\n            categoryTerms = category.toLowerCase().split(/[,\\s]+/);\n            categoryPatterns = categoryTerms.map(function (term) {\n              return new RegExp(term, 'i');\n            });\n            mainQuery.category = {\n              $in: categoryPatterns\n            };\n          }\n\n          // Add nutritional profile matching if available\n          if (productData.nutriments) {\n            nutrientRanges = {};\n            NUTRIENT_TOLERANCE = 0.3; // 30% tolerance for nutrient matching\n            // Check key nutrients\n            ['proteins_100g', 'fiber_100g', 'sugars_100g', 'fat_100g'].forEach(function (nutrient) {\n              var value = productData.nutriments[nutrient];\n              if (value) {\n                // For positive nutrients (protein, fiber), look for higher values\n                if (nutrient === 'proteins_100g' || nutrient === 'fiber_100g') {\n                  nutrientRanges[\"nutriments.\".concat(nutrient)] = {\n                    $gte: value\n                  };\n                }\n                // For negative nutrients (sugars, fat), look for lower values\n                else {\n                  nutrientRanges[\"nutriments.\".concat(nutrient)] = {\n                    $lte: value\n                  };\n                }\n              }\n            });\n\n            // Add nutritional criteria to query\n            if (Object.keys(nutrientRanges).length > 0) {\n              mainQuery.$or = [\n              // Match either by category or by nutritional profile\n              {\n                category: mainQuery.category\n              }, nutrientRanges];\n              delete mainQuery.category; // Remove from main query since it's in $or\n            }\n          }\n          console.log('Finding alternatives with query:', JSON.stringify(mainQuery, null, 2));\n\n          // Find alternatives\n          _context4.next = 17;\n          return Product.find(mainQuery).sort({\n            healthRating: -1,\n            'nutriments.proteins_100g': -1,\n            'nutriments.fiber_100g': -1\n          }).limit(6).lean();\n        case 17:\n          alternatives = _context4.sent;\n          console.log(\"Found \".concat(alternatives.length, \" alternatives\"));\n          if (!(alternatives.length === 0)) {\n            _context4.next = 30;\n            break;\n          }\n          console.log('No matches found, trying broader search');\n          // Try a broader search focusing only on health rating\n          broadQuery = {\n            _id: {\n              $ne: productData._id\n            },\n            healthRating: {\n              $gt: minHealthRating\n            }\n          };\n          _context4.next = 24;\n          return Product.find(broadQuery).sort({\n            healthRating: -1\n          }).limit(6).lean();\n        case 24:\n          broadAlternatives = _context4.sent;\n          console.log(\"Found \".concat(broadAlternatives.length, \" broad alternatives\"));\n          if (!(broadAlternatives.length > 0)) {\n            _context4.next = 30;\n            break;\n          }\n          _results = broadAlternatives.map(function (alt) {\n            var relevanceScore = calculateRelevanceScore(alt, productData);\n            var nutritionalImprovement = calculateNutritionalImprovement(alt, productData);\n            return _objectSpread(_objectSpread({}, alt._doc || alt), {}, {\n              tag: alt.healthRating >= 4.5 ? \"Healthiest Choice\" : alt.healthRating >= 4.0 ? \"Healthy Choice\" : \"Better Choice\",\n              relevanceScore: relevanceScore,\n              nutritionalImprovement: nutritionalImprovement,\n              description: generateAlternativeDescription(alt, nutritionalImprovement)\n            });\n          }); // Cache the results before sending\n          healthRatingCache.set({\n            _id: cacheKey\n          }, _results);\n          return _context4.abrupt(\"return\", res.json({\n            success: true,\n            alternatives: _results,\n            fromCache: false\n          }));\n        case 30:\n          // Process and return the alternatives with scores\n          results = alternatives.map(function (alt) {\n            var relevanceScore = calculateRelevanceScore(alt, productData);\n            var nutritionalImprovement = calculateNutritionalImprovement(alt, productData);\n            return _objectSpread(_objectSpread({}, alt._doc || alt), {}, {\n              tag: alt.healthRating >= 4.5 ? \"Healthiest Choice\" : alt.healthRating >= 4.0 ? \"Healthy Choice\" : \"Better Choice\",\n              relevanceScore: relevanceScore,\n              nutritionalImprovement: nutritionalImprovement,\n              description: generateAlternativeDescription(alt, nutritionalImprovement)\n            });\n          }); // Sort by combined score\n          results.sort(function (a, b) {\n            return b.relevanceScore + b.nutritionalImprovement - (a.relevanceScore + a.nutritionalImprovement);\n          });\n\n          // Cache the results before sending\n          healthRatingCache.set({\n            _id: cacheKey\n          }, results);\n          console.log(\"Returning \".concat(results.length, \" alternatives\"));\n          res.json({\n            success: true,\n            alternatives: results,\n            fromCache: false\n          });\n          _context4.next = 41;\n          break;\n        case 37:\n          _context4.prev = 37;\n          _context4.t0 = _context4[\"catch\"](0);\n          console.error('Failed to fetch healthier alternatives:', _context4.t0);\n          res.status(500).json({\n            success: false,\n            error: 'Failed to fetch healthier alternatives',\n            details: _context4.t0.message\n          });\n        case 41:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4, null, [[0, 37]]);\n  }));\n  return function (_x6, _x7) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\n// Helper function to calculate nutritional improvement\nfunction calculateNutritionalImprovement(alternative, originalProduct) {\n  if (!(originalProduct !== null && originalProduct !== void 0 && originalProduct.nutriments)) return 0;\n  var improvement = 0;\n  var nutrients = {\n    proteins_100g: {\n      weight: 0.3,\n      preferHigher: true\n    },\n    fiber_100g: {\n      weight: 0.3,\n      preferHigher: true\n    },\n    sugars_100g: {\n      weight: 0.2,\n      preferHigher: false\n    },\n    fat_100g: {\n      weight: 0.2,\n      preferHigher: false\n    }\n  };\n  Object.entries(nutrients).forEach(function (_ref5) {\n    var _alternative$nutrimen;\n    var _ref6 = _slicedToArray(_ref5, 2),\n      nutrient = _ref6[0],\n      _ref6$ = _ref6[1],\n      weight = _ref6$.weight,\n      preferHigher = _ref6$.preferHigher;\n    var original = originalProduct.nutriments[nutrient] || 0;\n    var alternative_value = ((_alternative$nutrimen = alternative.nutriments) === null || _alternative$nutrimen === void 0 ? void 0 : _alternative$nutrimen[nutrient]) || 0;\n    if (preferHigher) {\n      improvement += alternative_value > original ? weight : 0;\n    } else {\n      improvement += alternative_value < original ? weight : 0;\n    }\n  });\n  return improvement;\n}\n\n// Helper function to generate alternative description\nfunction generateAlternativeDescription(alternative, improvement) {\n  var _alternative$nutrimen2, _alternative$nutrimen3, _alternative$nutrimen4;\n  var improvements = [];\n  if (((_alternative$nutrimen2 = alternative.nutriments) === null || _alternative$nutrimen2 === void 0 ? void 0 : _alternative$nutrimen2.proteins_100g) > 5) {\n    improvements.push('higher in protein');\n  }\n  if (((_alternative$nutrimen3 = alternative.nutriments) === null || _alternative$nutrimen3 === void 0 ? void 0 : _alternative$nutrimen3.fiber_100g) > 3) {\n    improvements.push('rich in fiber');\n  }\n  if (((_alternative$nutrimen4 = alternative.nutriments) === null || _alternative$nutrimen4 === void 0 ? void 0 : _alternative$nutrimen4.sugars_100g) < 5) {\n    improvements.push('lower in sugar');\n  }\n  if (improvements.length > 0) {\n    return \"A healthier alternative that's \".concat(improvements.join(', '), \".\");\n  }\n  return \"A better choice with a health rating of \".concat(alternative.healthRating.toFixed(1), \".\");\n}\n\n// Helper function to calculate relevance score\nfunction calculateRelevanceScore(alternative, originalProduct) {\n  if (!originalProduct) return 1;\n  var score = 1;\n\n  // Category match bonus\n  if (alternative.category && originalProduct.category) {\n    if (alternative.category.toLowerCase() === originalProduct.category.toLowerCase()) {\n      score += 0.5;\n    }\n  }\n\n  // Nutritional profile similarity\n  if (alternative.nutriments && originalProduct.nutriments) {\n    var nutrients = ['proteins_100g', 'fiber_100g', 'sugars_100g', 'fat_100g'];\n    nutrients.forEach(function (nutrient) {\n      var altValue = alternative.nutriments[nutrient] || 0;\n      var origValue = originalProduct.nutriments[nutrient] || 0;\n      var diff = Math.abs(altValue - origValue);\n\n      // Add bonus for similar nutritional values\n      if (diff <= 2) score += 0.1;\n\n      // Add bonus for better nutritional values\n      if ((nutrient.includes('protein') || nutrient.includes('fiber')) && altValue > origValue) {\n        score += 0.1;\n      }\n      if ((nutrient.includes('sugar') || nutrient.includes('fat')) && altValue < origValue) {\n        score += 0.1;\n      }\n    });\n  }\n\n  // Special ingredients matching\n  if (alternative.ingredients && originalProduct.ingredients) {\n    // Handle different ingredient formats (string or array)\n    var getIngredientsString = function getIngredientsString(ingredients) {\n      if (typeof ingredients === 'string') return ingredients;\n      if (Array.isArray(ingredients)) {\n        return ingredients.map(function (ing) {\n          return _typeof(ing) === 'object' ? ing.text || ing.name || '' : ing;\n        }).join(' ');\n      }\n      return '';\n    };\n    var altIngredients = getIngredientsString(alternative.ingredients).toLowerCase();\n    var origIngredients = getIngredientsString(originalProduct.ingredients).toLowerCase();\n\n    // Common healthy ingredients bonus\n    var healthyIngredients = ['whole grain', 'oats', 'quinoa', 'nuts', 'seeds'];\n    healthyIngredients.forEach(function (ingredient) {\n      if (altIngredients.includes(ingredient)) {\n        score += 0.1;\n      }\n    });\n  }\n  return Math.min(2, score);\n}\n\n// Add Indian brands list\nvar INDIAN_BRANDS = ['amul', 'britannia', 'parle', 'haldirams', 'mtr', 'dabur', 'patanjali', 'mother dairy', 'tata', 'itc', 'nestle india', 'himalaya', 'fortune', 'bikaji', 'vadilal', 'everest', 'lijjat', 'bikano', 'aashirvaad', 'godrej'];\nexports.getIndianProducts = /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(req, res) {\n    var _req$query3, _req$query3$page, page, _req$query3$limit, limit, skip, query, _yield$Promise$all3, _yield$Promise$all4, products, total;\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.prev = 0;\n          _req$query3 = req.query, _req$query3$page = _req$query3.page, page = _req$query3$page === void 0 ? 1 : _req$query3$page, _req$query3$limit = _req$query3.limit, limit = _req$query3$limit === void 0 ? 12 : _req$query3$limit;\n          skip = (parseInt(page) - 1) * parseInt(limit);\n          query = {\n            $or: [{\n              brand: {\n                $in: INDIAN_BRANDS.map(function (brand) {\n                  return new RegExp(brand, 'i');\n                })\n              }\n            }, {\n              category: {\n                $in: ['indian', 'masala', 'curry', 'spices'].map(function (cat) {\n                  return new RegExp(cat, 'i');\n                })\n              }\n            }]\n          };\n          _context5.next = 6;\n          return Promise.all([Product.find(query).sort({\n            healthRating: -1,\n            searchCount: -1\n          }).skip(skip).limit(parseInt(limit)).lean(), Product.countDocuments(query)]);\n        case 6:\n          _yield$Promise$all3 = _context5.sent;\n          _yield$Promise$all4 = _slicedToArray(_yield$Promise$all3, 2);\n          products = _yield$Promise$all4[0];\n          total = _yield$Promise$all4[1];\n          res.json({\n            success: true,\n            products: products,\n            currentPage: parseInt(page),\n            totalPages: Math.ceil(total / parseInt(limit)),\n            total: total\n          });\n          _context5.next = 17;\n          break;\n        case 13:\n          _context5.prev = 13;\n          _context5.t0 = _context5[\"catch\"](0);\n          console.error('Failed to fetch Indian products:', _context5.t0);\n          res.status(500).json({\n            success: false,\n            error: 'Failed to fetch Indian products'\n          });\n        case 17:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee5, null, [[0, 13]]);\n  }));\n  return function (_x8, _x9) {\n    return _ref7.apply(this, arguments);\n  };\n}();\n\n// Update health ratings for products with caching\nfunction updateHealthRatings() {\n  return _updateHealthRatings.apply(this, arguments);\n} // Add cache cleanup on interval\nfunction _updateHealthRatings() {\n  _updateHealthRatings = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    var batchSize, updateInterval, priorityUpdateInterval, productsToUpdate, updatedCount, errorCount, cacheHits, updateResults, _iterator, _step, product, healthAnalysis, usedCache, processedIngredients, ratingChanged;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.prev = 0;\n          batchSize = 50;\n          updateInterval = 24 * 60 * 60 * 1000;\n          priorityUpdateInterval = 12 * 60 * 60 * 1000;\n          _context6.next = 6;\n          return Product.find({\n            $or: [{\n              lastFetched: {\n                $lt: new Date(Date.now() - updateInterval)\n              }\n            }, {\n              $or: [{\n                healthRating: {\n                  $exists: false\n                }\n              }, {\n                healthRating: null\n              }, {\n                healthRating: 3.0\n              }],\n              lastFetched: {\n                $lt: new Date(Date.now() - priorityUpdateInterval)\n              }\n            }, {\n              $and: [{\n                healthRating: {\n                  $exists: true\n                }\n              }, {\n                healthAnalysis: {\n                  $exists: false\n                }\n              }]\n            }]\n          }).sort({\n            lastFetched: 1\n          }).limit(batchSize);\n        case 6:\n          productsToUpdate = _context6.sent;\n          updatedCount = 0;\n          errorCount = 0;\n          cacheHits = 0;\n          updateResults = {\n            success: [],\n            failures: [],\n            cacheStats: null\n          };\n          _iterator = _createForOfIteratorHelper(productsToUpdate);\n          _context6.prev = 12;\n          _iterator.s();\n        case 14:\n          if ((_step = _iterator.n()).done) {\n            _context6.next = 34;\n            break;\n          }\n          product = _step.value;\n          _context6.prev = 16;\n          // Check cache first\n          healthAnalysis = healthRatingCache.get(product);\n          usedCache = false;\n          if (!healthAnalysis) {\n            // Calculate new health rating if not in cache\n            processedIngredients = Array.isArray(product.ingredients) ? product.ingredients.join(', ') : typeof product.ingredients === 'string' ? product.ingredients : '';\n            healthAnalysis = calculateHealthRating({\n              ingredients: processedIngredients,\n              nutriments: product.nutriments || {},\n              nutriscore_grade: product.nutriscore_grade,\n              name: product.name,\n              category: product.category\n            });\n\n            // Cache the result\n            healthRatingCache.set(product, healthAnalysis);\n          } else {\n            usedCache = true;\n            cacheHits++;\n          }\n\n          // Check if rating has changed significantly\n          ratingChanged = !product.healthRating || Math.abs(product.healthRating - healthAnalysis.score) >= 0.5; // Update product with new rating\n          _context6.next = 23;\n          return Product.updateOne({\n            _id: product._id\n          }, {\n            $set: {\n              healthRating: healthAnalysis.score,\n              healthAnalysis: healthAnalysis.analysis,\n              healthRatingLabel: healthAnalysis.rating,\n              healthRatingColor: healthAnalysis.color,\n              confidence: healthAnalysis.confidence,\n              dataCompleteness: healthAnalysis.dataCompleteness,\n              lastFetched: new Date(),\n              ratingChanged: ratingChanged,\n              lastSignificantUpdate: ratingChanged ? new Date() : product.lastSignificantUpdate,\n              cacheHit: usedCache\n            }\n          });\n        case 23:\n          updateResults.success.push({\n            id: product._id,\n            oldScore: product.healthRating,\n            newScore: healthAnalysis.score,\n            changed: ratingChanged,\n            fromCache: usedCache\n          });\n          updatedCount++;\n          _context6.next = 32;\n          break;\n        case 27:\n          _context6.prev = 27;\n          _context6.t0 = _context6[\"catch\"](16);\n          console.error(\"Error updating health rating for product \".concat(product._id, \":\"), _context6.t0);\n          updateResults.failures.push({\n            id: product._id,\n            error: _context6.t0.message\n          });\n          errorCount++;\n        case 32:\n          _context6.next = 14;\n          break;\n        case 34:\n          _context6.next = 39;\n          break;\n        case 36:\n          _context6.prev = 36;\n          _context6.t1 = _context6[\"catch\"](12);\n          _iterator.e(_context6.t1);\n        case 39:\n          _context6.prev = 39;\n          _iterator.f();\n          return _context6.finish(39);\n        case 42:\n          // Get cache statistics\n          updateResults.cacheStats = healthRatingCache.getStats();\n          console.log(\"Updated health ratings for \".concat(updatedCount, \" products (\").concat(cacheHits, \" cache hits) with \").concat(errorCount, \" errors\"));\n          console.log('Update results:', JSON.stringify(updateResults, null, 2));\n          return _context6.abrupt(\"return\", {\n            success: true,\n            updatedCount: updatedCount,\n            errorCount: errorCount,\n            cacheHits: cacheHits,\n            results: updateResults\n          });\n        case 48:\n          _context6.prev = 48;\n          _context6.t2 = _context6[\"catch\"](0);\n          console.error('Error in health rating update process:', _context6.t2);\n          return _context6.abrupt(\"return\", {\n            success: false,\n            error: _context6.t2.message\n          });\n        case 52:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6, null, [[0, 48], [12, 36, 39, 42], [16, 27]]);\n  }));\n  return _updateHealthRatings.apply(this, arguments);\n}\nsetInterval(function () {\n  var stats = healthRatingCache.getStats();\n  if (stats.expiredEntries > 0) {\n    console.log(\"Clearing \".concat(stats.expiredEntries, \" expired cache entries\"));\n    // Clear expired entries by forcing a get() on all entries\n    // This will trigger the expiration check and cleanup\n    _toConsumableArray(healthRatingCache.cache.keys()).forEach(function (key) {\n      return healthRatingCache.get({\n        _id: key\n      });\n    });\n  }\n}, 60 * 60 * 1000); // Run every hour\n\n// Run health rating updates every 6 hours\nsetInterval(updateHealthRatings, 6 * 60 * 60 * 1000);\n\n// Run initial update\nupdateHealthRatings();\n\n//# sourceURL=webpack://drive/./controllers/productController.js?");

/***/ }),

/***/ "./middleware/auth.js":
/*!****************************!*\
  !*** ./middleware/auth.js ***!
  \****************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nvar User = __webpack_require__(/*! ../models/user.model */ \"./models/user.model.js\");\nvar RefreshToken = __webpack_require__(/*! ../models/refresh-token.model */ \"./models/refresh-token.model.js\");\nvar _require = __webpack_require__(/*! ../utils/token-service */ \"./utils/token-service.js\"),\n  generateTokens = _require.generateTokens;\nmodule.exports = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(req, res, next) {\n    var _req$header, token, decoded, expiresIn, refreshThreshold, refreshToken, validRefreshToken, _user, tokens, user;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          token = (_req$header = req.header('Authorization')) === null || _req$header === void 0 ? void 0 : _req$header.replace('Bearer ', '');\n          if (token) {\n            _context.next = 4;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'No auth token found',\n            code: 'TOKEN_MISSING'\n          }));\n        case 4:\n          if (!TOKEN_BLACKLIST.has(token)) {\n            _context.next = 6;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'Token has been revoked',\n            code: 'TOKEN_REVOKED'\n          }));\n        case 6:\n          _context.prev = 6;\n          decoded = jwt.verify(token, process.env.JWT_SECRET, {\n            algorithms: ['HS256'] // Explicitly specify allowed algorithms\n          }); // Check if token is about to expire\n          expiresIn = decoded.exp * 1000 - Date.now();\n          refreshThreshold = 5 * 60 * 1000; // 5 minutes\n          // If token is about to expire and refresh token is present, generate new tokens\n          if (!(expiresIn < refreshThreshold && req.header('X-Refresh-Token'))) {\n            _context.next = 24;\n            break;\n          }\n          refreshToken = req.header('X-Refresh-Token');\n          _context.next = 14;\n          return RefreshToken.findOne({\n            token: refreshToken,\n            isRevoked: false,\n            expiresAt: {\n              $gt: new Date()\n            }\n          });\n        case 14:\n          validRefreshToken = _context.sent;\n          if (!validRefreshToken) {\n            _context.next = 24;\n            break;\n          }\n          _context.next = 18;\n          return User.findById(decoded.uid);\n        case 18:\n          _user = _context.sent;\n          if (!_user) {\n            _context.next = 24;\n            break;\n          }\n          _context.next = 22;\n          return generateTokens(_user, req.ip, req.headers['user-agent']);\n        case 22:\n          tokens = _context.sent;\n          // Set new tokens in response headers\n          res.set({\n            'X-Access-Token': tokens.accessToken,\n            'X-Refresh-Token': tokens.refreshToken,\n            'X-Token-Expiry': Date.now() + tokens.expiresIn * 1000\n          });\n        case 24:\n          if (!(!decoded.uid || !decoded.role)) {\n            _context.next = 26;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'Invalid token format',\n            code: 'TOKEN_INVALID_FORMAT'\n          }));\n        case 26:\n          if (!(expiresIn < 0)) {\n            _context.next = 28;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'Token has expired',\n            code: 'TOKEN_EXPIRED'\n          }));\n        case 28:\n          _context.next = 30;\n          return User.findById(decoded.userId);\n        case 30:\n          user = _context.sent;\n          if (user) {\n            _context.next = 33;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'User not found',\n            code: 'USER_NOT_FOUND'\n          }));\n        case 33:\n          // Add token expiry info to response headers\n          res.set({\n            'X-Token-Expiry': decoded.exp * 1000,\n            'X-Token-Refresh-Required': expiresIn < refreshThreshold ? 'true' : 'false'\n          });\n          req.user = user;\n          req.token = token;\n          next();\n          _context.next = 44;\n          break;\n        case 39:\n          _context.prev = 39;\n          _context.t0 = _context[\"catch\"](6);\n          if (!(_context.t0.name === 'TokenExpiredError')) {\n            _context.next = 43;\n            break;\n          }\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'Token has expired',\n            code: 'TOKEN_EXPIRED'\n          }));\n        case 43:\n          return _context.abrupt(\"return\", res.status(401).json({\n            message: 'Invalid token',\n            code: 'TOKEN_INVALID'\n          }));\n        case 44:\n          _context.next = 50;\n          break;\n        case 46:\n          _context.prev = 46;\n          _context.t1 = _context[\"catch\"](0);\n          console.error('Auth middleware error:', _context.t1);\n          res.status(500).json({\n            message: 'Authentication failed',\n            code: 'AUTH_ERROR'\n          });\n        case 50:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 46], [6, 39]]);\n  }));\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n//# sourceURL=webpack://drive/./middleware/auth.js?");

/***/ }),

/***/ "./middleware/errorMiddleware.js":
/*!***************************************!*\
  !*** ./middleware/errorMiddleware.js ***!
  \***************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar _require = __webpack_require__(/*! ../utils/errorHandler */ \"./utils/errorHandler.js\"),\n  AppError = _require.AppError,\n  ErrorCodes = _require.ErrorCodes,\n  errorResponse = _require.errorResponse;\n\n// For handling async errors without try-catch blocks\nvar catchAsync = function catchAsync(fn) {\n  return function (req, res, next) {\n    Promise.resolve(fn(req, res, next))[\"catch\"](next);\n  };\n};\n\n// Convert Mongoose validation errors to AppError format\nvar handleMongooseValidationError = function handleMongooseValidationError(err) {\n  var validationErrors = Object.values(err.errors).map(function (error) {\n    return {\n      field: error.path,\n      message: error.message,\n      value: error.value\n    };\n  });\n  return new AppError('Validation failed', 400, ErrorCodes.VALIDATION_ERROR, validationErrors);\n};\n\n// Handle cast errors (e.g., invalid MongoDB ObjectId)\nvar handleCastError = function handleCastError(err) {\n  return new AppError(\"Invalid \".concat(err.path, \": \").concat(err.value), 400, ErrorCodes.VALIDATION_ERROR);\n};\n\n// Handle duplicate key errors\nvar handleDuplicateKeyError = function handleDuplicateKeyError(err) {\n  var field = Object.keys(err.keyPattern)[0];\n  return new AppError(\"Duplicate value for field: \".concat(field, \". This \").concat(field, \" already exists.\"), 400, ErrorCodes.CONFLICT);\n};\n\n// Handle JWT errors\nvar handleJWTError = function handleJWTError() {\n  return new AppError('Invalid token. Please log in again.', 401, ErrorCodes.INVALID_TOKEN);\n};\nvar handleJWTExpiredError = function handleJWTExpiredError() {\n  return new AppError('Your token has expired. Please log in again.', 401, ErrorCodes.INVALID_TOKEN);\n};\n\n// Global error handling middleware\nvar globalErrorHandler = function globalErrorHandler(err, req, res, next) {\n  console.error('Error:', {\n    name: err.name,\n    message: err.message,\n    stack: err.stack,\n    errorCode: err.errorCode\n  });\n\n  // Default values\n  var error = _objectSpread({}, err);\n  error.message = err.message;\n  error.errorCode = err.errorCode;\n\n  // Handle specific error types\n  if (err.name === 'ValidationError') {\n    error = handleMongooseValidationError(err);\n  } else if (err.name === 'CastError') {\n    error = handleCastError(err);\n  } else if (err.code === 11000) {\n    error = handleDuplicateKeyError(err);\n  } else if (err.name === 'JsonWebTokenError') {\n    error = handleJWTError();\n  } else if (err.name === 'TokenExpiredError') {\n    error = handleJWTExpiredError();\n  }\n\n  // Create response based on the environment\n  var response = errorResponse(error, \"development\" === 'development');\n\n  // Set status code\n  var statusCode = error.statusCode || 500;\n\n  // Log error details in development\n  if (true) {\n    console.error('Full error details:', {\n      error: error,\n      originalError: err,\n      stack: err.stack\n    });\n  }\n\n  // Send error response\n  res.status(statusCode).json(response);\n};\n\n// Handle uncaught exceptions and unhandled rejections\nvar setupErrorHandlers = function setupErrorHandlers(app) {\n  process.on('uncaughtException', function (err) {\n    console.error('UNCAUGHT EXCEPTION!  Shutting down...');\n    console.error(err.name, err.message, err.stack);\n    process.exit(1);\n  });\n  process.on('unhandledRejection', function (err) {\n    console.error('UNHANDLED REJECTION!  Shutting down...');\n    console.error(err.name, err.message, err.stack);\n    process.exit(1);\n  });\n\n  // Handle SIGTERM\n  process.on('SIGTERM', function () {\n    console.log(' SIGTERM RECEIVED. Shutting down gracefully');\n    process.exit(1);\n  });\n};\nmodule.exports = {\n  catchAsync: catchAsync,\n  globalErrorHandler: globalErrorHandler,\n  setupErrorHandlers: setupErrorHandlers\n};\n\n//# sourceURL=webpack://drive/./middleware/errorMiddleware.js?");

/***/ }),

/***/ "./middleware/security.js":
/*!********************************!*\
  !*** ./middleware/security.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("var xss = __webpack_require__(/*! xss */ \"xss\");\nvar _require = __webpack_require__(/*! express-rate-limit */ \"express-rate-limit\"),\n  rateLimit = _require.rateLimit;\n\n// XSS prevention middleware\nvar xssPreventionMiddleware = function xssPreventionMiddleware(req, res, next) {\n  if (req.body) {\n    for (var key in req.body) {\n      if (typeof req.body[key] === 'string') {\n        req.body[key] = xss(req.body[key]);\n      }\n    }\n  }\n  next();\n};\n\n// Global rate limiter\nvar globalRateLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  // 15 minutes\n  max: 100,\n  // Limit each IP to 100 requests per window\n  message: 'Too many requests from this IP, please try again later',\n  standardHeaders: true,\n  legacyHeaders: false\n});\n\n// API rate limiter (stricter)\nvar apiRateLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 50,\n  message: 'Too many API requests from this IP, please try again later',\n  standardHeaders: true,\n  legacyHeaders: false\n});\nmodule.exports = {\n  xssPreventionMiddleware: xssPreventionMiddleware,\n  globalRateLimiter: globalRateLimiter,\n  apiRateLimiter: apiRateLimiter\n};\n\n//# sourceURL=webpack://drive/./middleware/security.js?");

/***/ }),

/***/ "./middleware/upload.js":
/*!******************************!*\
  !*** ./middleware/upload.js ***!
  \******************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar multer = __webpack_require__(/*! multer */ \"multer\");\nvar path = __webpack_require__(/*! path */ \"path\");\nvar fs = (__webpack_require__(/*! fs */ \"fs\").promises);\n\n// Configure multer for file uploads\nvar storage = multer.diskStorage({\n  destination: function () {\n    var _destination = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(req, file, cb) {\n      var uploadDir;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            uploadDir = path.join(__dirname, '..', 'uploads', 'products');\n            _context.prev = 1;\n            _context.next = 4;\n            return fs.access(uploadDir);\n          case 4:\n            _context.next = 10;\n            break;\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](1);\n            _context.next = 10;\n            return fs.mkdir(uploadDir, {\n              recursive: true\n            });\n          case 10:\n            cb(null, uploadDir);\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[1, 6]]);\n    }));\n    function destination(_x, _x2, _x3) {\n      return _destination.apply(this, arguments);\n    }\n    return destination;\n  }(),\n  filename: function filename(req, file, cb) {\n    // Create unique filename with timestamp and original extension\n    var uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    cb(null, file.fieldname + '-' + uniqueSuffix + path.extname(file.originalname));\n  }\n});\n\n// File filter to only allow image files\nvar fileFilter = function fileFilter(req, file, cb) {\n  var allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];\n  if (allowedTypes.includes(file.mimetype)) {\n    cb(null, true);\n  } else {\n    cb(new Error('Invalid file type. Only JPEG, PNG and GIF images are allowed.'), false);\n  }\n};\n\n// Configure multer with our options\nvar upload = multer({\n  storage: storage,\n  fileFilter: fileFilter,\n  limits: {\n    fileSize: 5 * 1024 * 1024 // 5MB file size limit\n  }\n});\n\n// Export middleware for different upload scenarios\nmodule.exports = {\n  // For single file uploads\n  uploadProductImage: upload.single('productImage'),\n  uploadBarcodeImage: upload.single('barcodeImage'),\n  // For multiple files (both product and barcode images)\n  uploadProductImages: upload.fields([{\n    name: 'productImage',\n    maxCount: 1\n  }, {\n    name: 'barcodeImage',\n    maxCount: 1\n  }]),\n  // Error handling middleware\n  handleUploadError: function handleUploadError(err, req, res, next) {\n    if (err instanceof multer.MulterError) {\n      if (err.code === 'LIMIT_FILE_SIZE') {\n        return res.status(400).json({\n          success: false,\n          message: 'File is too large. Maximum size is 5MB.'\n        });\n      }\n      return res.status(400).json({\n        success: false,\n        message: err.message\n      });\n    }\n    if (err) {\n      return res.status(400).json({\n        success: false,\n        message: err.message\n      });\n    }\n    next();\n  }\n};\n\n//# sourceURL=webpack://drive/./middleware/upload.js?");

/***/ }),

/***/ "./models/Product.js":
/*!***************************!*\
  !*** ./models/Product.js ***!
  \***************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nvar HealthHistorySchema = new mongoose.Schema({\n  score: {\n    type: Number,\n    required: [true, 'Health score is required'],\n    min: [0, 'Health score cannot be negative'],\n    max: [5, 'Health score cannot exceed 5']\n  },\n  timestamp: {\n    type: Date,\n    \"default\": Date.now,\n    required: [true, 'Timestamp is required'],\n    validate: {\n      validator: function validator(value) {\n        return value <= Date.now();\n      },\n      message: 'Health history timestamp cannot be in the future'\n    }\n  },\n  reason: {\n    type: String,\n    required: [true, 'Reason for health score change is required'],\n    trim: true,\n    maxlength: [500, 'Reason cannot exceed 500 characters']\n  }\n});\nvar productSchema = new mongoose.Schema({\n  barcode: {\n    type: String,\n    required: [true, 'Barcode is required'],\n    unique: true,\n    index: true,\n    validate: {\n      validator: function validator(v) {\n        return /^[0-9]{8,14}$/.test(v);\n      },\n      message: function message(props) {\n        return \"\".concat(props.value, \" is not a valid barcode number. Must be 8-14 digits.\");\n      }\n    }\n  },\n  name: {\n    type: String,\n    required: [true, 'Product name is required'],\n    trim: true,\n    index: true,\n    minlength: [2, 'Product name must be at least 2 characters long'],\n    maxlength: [100, 'Product name cannot exceed 100 characters']\n  },\n  brand: {\n    type: String,\n    trim: true,\n    index: true,\n    maxlength: [50, 'Brand name cannot exceed 50 characters']\n  },\n  productImage: {\n    type: String,\n    validate: {\n      validator: function validator(v) {\n        return !v || /\\.(jpg|jpeg|png)$/i.test(v);\n      },\n      message: 'Product image must be a valid image file (JPG, JPEG, or PNG)'\n    }\n  },\n  barcodeImage: {\n    type: String,\n    validate: {\n      validator: function validator(v) {\n        return !v || /\\.(jpg|jpeg|png)$/i.test(v);\n      },\n      message: 'Barcode image must be a valid image file (JPG, JPEG, or PNG)'\n    }\n  },\n  category: {\n    type: String,\n    trim: true,\n    index: true,\n    \"enum\": {\n      values: ['Uncategorized', 'dairy', 'snacks', 'beverages', 'grains', 'fruits', 'meat', 'seafood', 'bakery', 'condiments', 'frozen', 'organic'],\n      message: '{VALUE} is not a valid category'\n    },\n    \"default\": 'Uncategorized'\n  },\n  description: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Description cannot exceed 1000 characters']\n  },\n  ingredients: [{\n    type: String,\n    trim: true,\n    maxlength: [100, 'Individual ingredient name cannot exceed 100 characters']\n  }],\n  labels: {\n    type: String,\n    trim: true,\n    maxlength: [200, 'Labels cannot exceed 200 characters']\n  },\n  allergens: [{\n    type: String,\n    trim: true,\n    maxlength: [50, 'Allergen name cannot exceed 50 characters']\n  }],\n  nutriments: {\n    energy_kcal_100g: {\n      type: Number,\n      min: [0, 'Energy value cannot be negative'],\n      max: [1000, 'Energy value seems too high']\n    },\n    carbohydrates_100g: {\n      type: Number,\n      min: [0, 'Carbohydrates value cannot be negative'],\n      max: [100, 'Carbohydrates value cannot exceed 100g per 100g']\n    },\n    sugars_100g: {\n      type: Number,\n      min: [0, 'Sugars value cannot be negative'],\n      max: [100, 'Sugars value cannot exceed 100g per 100g']\n    },\n    fat_100g: {\n      type: Number,\n      min: [0, 'Fat value cannot be negative'],\n      max: [100, 'Fat value cannot exceed 100g per 100g']\n    },\n    saturated_fat_100g: {\n      type: Number,\n      min: [0, 'Saturated fat value cannot be negative'],\n      max: [100, 'Saturated fat value cannot exceed 100g per 100g']\n    },\n    proteins_100g: {\n      type: Number,\n      min: [0, 'Proteins value cannot be negative'],\n      max: [100, 'Proteins value cannot exceed 100g per 100g']\n    },\n    fiber_100g: {\n      type: Number,\n      min: [0, 'Fiber value cannot be negative'],\n      max: [100, 'Fiber value cannot exceed 100g per 100g']\n    },\n    salt_100g: {\n      type: Number,\n      min: [0, 'Salt value cannot be negative'],\n      max: [100, 'Salt value cannot exceed 100g per 100g']\n    }\n  },\n  nutriscore_grade: {\n    type: String,\n    \"enum\": {\n      values: ['a', 'b', 'c', 'd', 'e'],\n      message: '{VALUE} is not a valid Nutri-Score grade'\n    }\n  },\n  healthRating: {\n    type: Number,\n    \"default\": 3.0,\n    required: [true, 'Health rating is required'],\n    validate: {\n      validator: function validator(v) {\n        return v >= 1 && v <= 5;\n      },\n      message: 'Health rating must be between 1 and 5'\n    }\n  },\n  healthAnalysis: [{\n    type: String,\n    trim: true,\n    maxlength: [500, 'Health analysis item cannot exceed 500 characters']\n  }],\n  healthRatingLabel: {\n    type: String,\n    trim: true,\n    maxlength: [50, 'Health rating label cannot exceed 50 characters'],\n    \"enum\": {\n      values: ['Excellent Choice', 'Healthy Choice', 'Good Choice', 'Fair Choice', 'Poor Choice'],\n      message: '{VALUE} is not a valid health rating label'\n    }\n  },\n  healthRatingColor: {\n    type: String,\n    trim: true,\n    validate: {\n      validator: function validator(v) {\n        return /^#[0-9A-Fa-f]{6}$/.test(v);\n      },\n      message: 'Health rating color must be a valid hex color code'\n    }\n  },\n  confidence: {\n    type: Number,\n    required: [true, 'Confidence score is required'],\n    min: [0, 'Confidence score cannot be negative'],\n    max: [1, 'Confidence score cannot exceed 1'],\n    \"default\": 0.5\n  },\n  dataCompleteness: {\n    type: Number,\n    required: [true, 'Data completeness score is required'],\n    min: [0, 'Data completeness cannot be negative'],\n    max: [100, 'Data completeness cannot exceed 100%'],\n    \"default\": 0\n  },\n  lastSignificantUpdate: {\n    type: Date,\n    validate: {\n      validator: function validator(value) {\n        return !value || value <= Date.now();\n      },\n      message: 'Last significant update date cannot be in the future'\n    }\n  },\n  ratingChanged: {\n    type: Boolean,\n    \"default\": false\n  },\n  cacheHit: {\n    type: Boolean,\n    \"default\": false\n  },\n  healthHistory: [HealthHistorySchema],\n  healthTrends: {\n    avgScore30Days: {\n      type: Number,\n      min: [1, 'Average score cannot be less than 1'],\n      max: [5, 'Average score cannot exceed 5']\n    },\n    avgScore90Days: {\n      type: Number,\n      min: [1, 'Average score cannot be less than 1'],\n      max: [5, 'Average score cannot exceed 5']\n    },\n    improvement30Days: {\n      type: Number,\n      min: [-5, 'Improvement cannot be less than -5'],\n      max: [5, 'Improvement cannot exceed 5']\n    },\n    improvement90Days: {\n      type: Number,\n      min: [-5, 'Improvement cannot be less than -5'],\n      max: [5, 'Improvement cannot exceed 5']\n    },\n    lastAnalyzed: {\n      type: Date,\n      validate: {\n        validator: function validator(value) {\n          return !value || value <= Date.now();\n        },\n        message: 'Last analyzed date cannot be in the future'\n      }\n    }\n  },\n  searchCount: {\n    type: Number,\n    \"default\": 0,\n    min: [0, 'Search count cannot be negative'],\n    index: true\n  },\n  lastFetched: {\n    type: Date,\n    \"default\": Date.now,\n    index: true,\n    validate: {\n      validator: function validator(value) {\n        return !value || value <= Date.now();\n      },\n      message: 'Last fetched date cannot be in the future'\n    }\n  },\n  addedBy: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'user',\n    required: [true, 'Added by user reference is required'],\n    validate: {\n      validator: function () {\n        var _validator = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(value) {\n          var User, user;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                User = mongoose.model('user');\n                _context.next = 4;\n                return User.findById(value);\n              case 4:\n                user = _context.sent;\n                return _context.abrupt(\"return\", user !== null);\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", false);\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, null, [[0, 8]]);\n        }));\n        function validator(_x) {\n          return _validator.apply(this, arguments);\n        }\n        return validator;\n      }(),\n      message: 'The specified user does not exist'\n    }\n  },\n  isVerified: {\n    type: Boolean,\n    \"default\": false\n  },\n  verifiedBy: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'user',\n    validate: {\n      validator: function () {\n        var _validator2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(value) {\n          var User, user;\n          return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n            while (1) switch (_context2.prev = _context2.next) {\n              case 0:\n                if (value) {\n                  _context2.next = 2;\n                  break;\n                }\n                return _context2.abrupt(\"return\", true);\n              case 2:\n                _context2.prev = 2;\n                User = mongoose.model('user');\n                _context2.next = 6;\n                return User.findById(value);\n              case 6:\n                user = _context2.sent;\n                return _context2.abrupt(\"return\", user !== null && user.role === 'admin');\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](2);\n                return _context2.abrupt(\"return\", false);\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }, _callee2, null, [[2, 10]]);\n        }));\n        function validator(_x2) {\n          return _validator2.apply(this, arguments);\n        }\n        return validator;\n      }(),\n      message: 'Product can only be verified by an admin user'\n    }\n  },\n  verifiedAt: {\n    type: Date,\n    validate: {\n      validator: function validator(value) {\n        return !value || value <= Date.now();\n      },\n      message: 'Verification date cannot be in the future'\n    }\n  }\n}, {\n  timestamps: true\n});\n\n// Create text indexes for better search performance\nproductSchema.index({\n  name: 'text',\n  brand: 'text',\n  category: 'text',\n  description: 'text'\n}, {\n  weights: {\n    name: 10,\n    brand: 5,\n    category: 3,\n    description: 1\n  }\n});\n\n// Add method to update health history\nproductSchema.methods.updateHealthHistory = function (newScore, reason) {\n  if (!reason) {\n    throw new Error('A reason is required when updating health history');\n  }\n  if (newScore < 1 || newScore > 5) {\n    throw new Error('Health score must be between 1 and 5');\n  }\n  this.healthHistory.push({\n    score: newScore,\n    reason: reason,\n    timestamp: new Date()\n  });\n  // Keep only last 365 days of history\n  var oneYearAgo = new Date();\n  oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);\n  this.healthHistory = this.healthHistory.filter(function (h) {\n    return h.timestamp >= oneYearAgo;\n  });\n\n  // Calculate and update trends\n  this.calculateHealthTrends();\n  this.ratingChanged = true;\n  return this.save();\n};\n\n// Calculate health trends\nproductSchema.methods.calculateHealthTrends = function () {\n  var now = new Date();\n  var thirtyDaysAgo = new Date(now - 30 * 24 * 60 * 60 * 1000);\n  var ninetyDaysAgo = new Date(now - 90 * 24 * 60 * 60 * 1000);\n\n  // Calculate averages\n  var last30Days = this.healthHistory.filter(function (h) {\n    return h.timestamp >= thirtyDaysAgo;\n  });\n  var last90Days = this.healthHistory.filter(function (h) {\n    return h.timestamp >= ninetyDaysAgo;\n  });\n  this.healthTrends = {\n    avgScore30Days: last30Days.length > 0 ? parseFloat((last30Days.reduce(function (sum, h) {\n      return sum + h.score;\n    }, 0) / last30Days.length).toFixed(2)) : null,\n    avgScore90Days: last90Days.length > 0 ? parseFloat((last90Days.reduce(function (sum, h) {\n      return sum + h.score;\n    }, 0) / last90Days.length).toFixed(2)) : null,\n    improvement30Days: last30Days.length >= 2 ? parseFloat((last30Days[last30Days.length - 1].score - last30Days[0].score).toFixed(2)) : null,\n    improvement90Days: last90Days.length >= 2 ? parseFloat((last90Days[last90Days.length - 1].score - last90Days[0].score).toFixed(2)) : null,\n    lastAnalyzed: now\n  };\n};\n\n// Calculate data completeness score\nproductSchema.methods.calculateDataCompleteness = function () {\n  var _this = this;\n  var requiredFields = ['name', 'brand', 'category', 'ingredients', 'nutriments'];\n  var optionalFields = ['description', 'allergens', 'labels', 'nutriscore_grade'];\n  var nutrimentFields = ['energy_kcal_100g', 'carbohydrates_100g', 'proteins_100g', 'fat_100g'];\n  var score = 0;\n  var totalFields = requiredFields.length + optionalFields.length + nutrimentFields.length;\n\n  // Check required fields\n  requiredFields.forEach(function (field) {\n    if (_this[field] && (Array.isArray(_this[field]) ? _this[field].length > 0 : true)) {\n      score += 2; // Weight required fields more heavily\n    }\n  });\n\n  // Check optional fields\n  optionalFields.forEach(function (field) {\n    if (_this[field] && (Array.isArray(_this[field]) ? _this[field].length > 0 : true)) {\n      score += 1;\n    }\n  });\n\n  // Check nutriment fields\n  nutrimentFields.forEach(function (field) {\n    if (_this.nutriments && _this.nutriments[field] !== undefined) {\n      score += 1;\n    }\n  });\n\n  // Calculate percentage and update\n  this.dataCompleteness = parseFloat((score / (totalFields + requiredFields.length) * 100).toFixed(2));\n  return this.save();\n};\n\n// Pre-save middleware to update timestamps and completeness\nproductSchema.pre('save', function (next) {\n  if (this.isModified()) {\n    this.lastSignificantUpdate = new Date();\n    this.calculateDataCompleteness();\n  }\n  next();\n});\n\n// Add method to calculate health trends\nproductSchema.methods.updateHealthTrends = function () {\n  var now = new Date();\n  var thirtyDaysAgo = new Date(now - 30 * 24 * 60 * 60 * 1000);\n  var ninetyDaysAgo = new Date(now - 90 * 24 * 60 * 60 * 1000);\n\n  // Calculate averages\n  var history30Days = this.healthHistory.filter(function (h) {\n    return h.timestamp >= thirtyDaysAgo;\n  });\n  var history90Days = this.healthHistory.filter(function (h) {\n    return h.timestamp >= ninetyDaysAgo;\n  });\n  if (history30Days.length > 0) {\n    this.healthTrends.avgScore30Days = history30Days.reduce(function (sum, h) {\n      return sum + h.score;\n    }, 0) / history30Days.length;\n\n    // Calculate improvement (compare to oldest score in period)\n    var oldestScore30 = history30Days[0].score;\n    this.healthTrends.improvement30Days = (this.healthRating - oldestScore30) / oldestScore30 * 100;\n  }\n  if (history90Days.length > 0) {\n    this.healthTrends.avgScore90Days = history90Days.reduce(function (sum, h) {\n      return sum + h.score;\n    }, 0) / history90Days.length;\n    var oldestScore90 = history90Days[0].score;\n    this.healthTrends.improvement90Days = (this.healthRating - oldestScore90) / oldestScore90 * 100;\n  }\n  this.healthTrends.lastAnalyzed = now;\n};\n\n// Add static method to get trending products\nproductSchema.statics.getTrendingProducts = /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n  var options,\n    _options$limit,\n    limit,\n    _options$minImproveme,\n    minImprovement,\n    _options$period,\n    period,\n    query,\n    _args3 = arguments;\n  return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n    while (1) switch (_context3.prev = _context3.next) {\n      case 0:\n        options = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {};\n        _options$limit = options.limit, limit = _options$limit === void 0 ? 10 : _options$limit, _options$minImproveme = options.minImprovement, minImprovement = _options$minImproveme === void 0 ? 5 : _options$minImproveme, _options$period = options.period, period = _options$period === void 0 ? 30 : _options$period;\n        query = _defineProperty(_defineProperty({}, \"healthTrends.improvement\".concat(period, \"Days\"), {\n          $gte: minImprovement\n        }), \"healthTrends.avgScore\".concat(period, \"Days\"), {\n          $exists: true\n        });\n        return _context3.abrupt(\"return\", this.find(query).sort(_defineProperty({}, \"healthTrends.improvement\".concat(period, \"Days\"), -1)).limit(limit));\n      case 4:\n      case \"end\":\n        return _context3.stop();\n    }\n  }, _callee3, this);\n}));\nmodule.exports = mongoose.model('Product', productSchema);\n\n//# sourceURL=webpack://drive/./models/Product.js?");

/***/ }),

/***/ "./models/ProductSubmission.js":
/*!*************************************!*\
  !*** ./models/ProductSubmission.js ***!
  \*************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nvar productSubmissionSchema = new mongoose.Schema({\n  productName: {\n    type: String,\n    required: [true, 'Product name is required'],\n    trim: true,\n    minlength: [2, 'Product name must be at least 2 characters long'],\n    maxlength: [100, 'Product name cannot exceed 100 characters']\n  },\n  barcodeNumber: {\n    type: String,\n    required: [true, 'Barcode number is required'],\n    unique: true,\n    sparse: true,\n    validate: {\n      validator: function validator(v) {\n        // Basic validation for common barcode formats (EAN-13, UPC-A, EAN-8)\n        return /^[0-9]{8,14}$/.test(v);\n      },\n      message: function message(props) {\n        return \"\".concat(props.value, \" is not a valid barcode number. Must be 8-14 digits.\");\n      }\n    }\n  },\n  brand: {\n    type: String,\n    trim: true,\n    \"default\": 'Not specified',\n    maxlength: [50, 'Brand name cannot exceed 50 characters']\n  },\n  category: {\n    type: String,\n    trim: true,\n    \"default\": 'Uncategorized',\n    \"enum\": {\n      values: ['Uncategorized', 'dairy', 'snacks', 'beverages', 'grains', 'fruits', 'meat', 'seafood', 'bakery', 'condiments', 'frozen', 'organic'],\n      message: '{VALUE} is not a valid category'\n    }\n  },\n  ingredients: [{\n    type: String,\n    trim: true,\n    maxlength: [100, 'Individual ingredient name cannot exceed 100 characters']\n  }],\n  nutritionalInfo: {\n    servingSize: {\n      type: String,\n      trim: true,\n      maxlength: [50, 'Serving size description cannot exceed 50 characters']\n    },\n    calories: {\n      type: Number,\n      min: [0, 'Calories cannot be negative'],\n      max: [10000, 'Calories value seems too high']\n    },\n    protein: {\n      type: Number,\n      min: [0, 'Protein content cannot be negative'],\n      max: [1000, 'Protein value seems too high']\n    },\n    carbohydrates: {\n      type: Number,\n      min: [0, 'Carbohydrate content cannot be negative'],\n      max: [1000, 'Carbohydrate value seems too high']\n    },\n    fat: {\n      type: Number,\n      min: [0, 'Fat content cannot be negative'],\n      max: [1000, 'Fat value seems too high']\n    },\n    fiber: {\n      type: Number,\n      min: [0, 'Fiber content cannot be negative'],\n      max: [100, 'Fiber value seems too high']\n    },\n    sugar: {\n      type: Number,\n      min: [0, 'Sugar content cannot be negative'],\n      max: [100, 'Sugar value seems too high']\n    },\n    sodium: {\n      type: Number,\n      min: [0, 'Sodium content cannot be negative'],\n      max: [10000, 'Sodium value seems too high']\n    }\n  },\n  allergens: [{\n    type: String,\n    trim: true,\n    maxlength: [50, 'Allergen name cannot exceed 50 characters']\n  }],\n  dietaryInfo: [{\n    type: String,\n    trim: true,\n    \"enum\": {\n      values: ['Vegan', 'Vegetarian', 'Gluten-Free', 'Lactose-Free', 'Organic', 'Kosher', 'Halal', 'Low-Carb', 'Sugar-Free', 'Keto-Friendly'],\n      message: '{VALUE} is not a recognized dietary category'\n    }\n  }],\n  productImage: {\n    type: String,\n    required: [true, 'Product image is required'],\n    validate: {\n      validator: function validator(v) {\n        return /\\.(jpg|jpeg|png)$/i.test(v);\n      },\n      message: 'Product image must be a valid image file (JPG, JPEG, or PNG)'\n    }\n  },\n  barcodeImage: {\n    type: String,\n    required: [true, 'Barcode image is required'],\n    validate: {\n      validator: function validator(v) {\n        return /\\.(jpg|jpeg|png)$/i.test(v);\n      },\n      message: 'Barcode image must be a valid image file (JPG, JPEG, or PNG)'\n    }\n  },\n  status: {\n    type: String,\n    \"enum\": {\n      values: ['pending', 'in_review', 'approved', 'rejected'],\n      message: '{VALUE} is not a valid submission status'\n    },\n    \"default\": 'pending',\n    required: [true, 'Submission status is required']\n  },\n  adminNotes: {\n    type: String,\n    trim: true,\n    maxlength: [1000, 'Admin notes cannot exceed 1000 characters']\n  },\n  reviewHistory: [{\n    status: {\n      type: String,\n      \"enum\": {\n        values: ['pending', 'in_review', 'approved', 'rejected'],\n        message: '{VALUE} is not a valid review status'\n      },\n      required: [true, 'Review status is required']\n    },\n    notes: {\n      type: String,\n      trim: true,\n      maxlength: [1000, 'Review notes cannot exceed 1000 characters']\n    },\n    updatedBy: {\n      type: mongoose.Schema.Types.ObjectId,\n      ref: 'user',\n      required: [true, 'Reviewer information is required']\n    },\n    updatedAt: {\n      type: Date,\n      \"default\": Date.now,\n      required: [true, 'Review timestamp is required']\n    }\n  }],\n  submittedBy: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'user',\n    required: [true, 'Submitter information is required'],\n    validate: {\n      validator: function () {\n        var _validator = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(value) {\n          var User, user;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                User = mongoose.model('user');\n                _context.next = 4;\n                return User.findById(value);\n              case 4:\n                user = _context.sent;\n                return _context.abrupt(\"return\", user !== null);\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", false);\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, null, [[0, 8]]);\n        }));\n        function validator(_x) {\n          return _validator.apply(this, arguments);\n        }\n        return validator;\n      }(),\n      message: 'The specified user does not exist'\n    }\n  },\n  submittedAt: {\n    type: Date,\n    \"default\": Date.now,\n    required: [true, 'Submission timestamp is required'],\n    validate: {\n      validator: function validator(value) {\n        return value <= Date.now();\n      },\n      message: 'Submission date cannot be in the future'\n    }\n  },\n  updatedAt: {\n    type: Date,\n    \"default\": Date.now,\n    required: [true, 'Last update timestamp is required']\n  }\n});\nproductSubmissionSchema.pre('save', function (next) {\n  this.updatedAt = new Date();\n  next();\n});\nvar ProductSubmission = mongoose.model('ProductSubmission', productSubmissionSchema);\nmodule.exports = ProductSubmission;\n\n//# sourceURL=webpack://drive/./models/ProductSubmission.js?");

/***/ }),

/***/ "./models/refresh-token.model.js":
/*!***************************************!*\
  !*** ./models/refresh-token.model.js ***!
  \***************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("var mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nvar refreshTokenSchema = new mongoose.Schema({\n  userId: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'User',\n    required: true\n  },\n  token: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  expiresAt: {\n    type: Date,\n    required: true\n  },\n  createdAt: {\n    type: Date,\n    \"default\": Date.now,\n    expires: 30 * 24 * 60 * 60 // Auto-delete after 30 days\n  },\n  isRevoked: {\n    type: Boolean,\n    \"default\": false\n  },\n  userAgent: String,\n  ipAddress: String\n});\n\n// Index for faster lookups and automatic expiration\nrefreshTokenSchema.index({\n  expiresAt: 1\n}, {\n  expireAfterSeconds: 0\n});\nrefreshTokenSchema.index({\n  userId: 1,\n  isRevoked: 1\n});\nmodule.exports = mongoose.model('RefreshToken', refreshTokenSchema);\n\n//# sourceURL=webpack://drive/./models/refresh-token.model.js?");

/***/ }),

/***/ "./models/user.model.js":
/*!******************************!*\
  !*** ./models/user.model.js ***!
  \******************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar mongoose = __webpack_require__(/*! mongoose */ \"mongoose\");\nvar userSchema = new mongoose.Schema({\n  username: {\n    type: String,\n    required: true,\n    trim: true,\n    lowercase: true,\n    unique: true,\n    minlength: [3, \"user must be 3 letters\"]\n  },\n  email: {\n    type: String,\n    required: true,\n    trim: true,\n    lowercase: true,\n    unique: true,\n    match: [/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/, 'Please enter a valid email address']\n  },\n  password: {\n    type: String,\n    required: true,\n    validate: {\n      validator: function validator(value) {\n        // At least 8 characters, 1 uppercase, 1 lowercase, 1 number\n        return /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[a-zA-Z\\d\\W]{8,}$/.test(value);\n      },\n      message: 'Password must be at least 8 characters long and contain at least one uppercase letter, one lowercase letter, and one number'\n    }\n  },\n  role: {\n    type: String,\n    \"enum\": ['user', 'admin'],\n    \"default\": 'user'\n  },\n  dietaryPreferences: {\n    type: [String],\n    \"default\": []\n  },\n  allergies: {\n    type: [String],\n    \"default\": []\n  },\n  resetOTP: {\n    type: String\n  },\n  otpExpiry: {\n    type: Date\n  },\n  lastOTPAttempt: {\n    type: Date\n  },\n  otpAttempts: {\n    type: Number,\n    \"default\": 0\n  },\n  createdAt: {\n    type: Date,\n    \"default\": Date.now\n  },\n  lastLogin: {\n    type: Date\n  },\n  failedLoginAttempts: {\n    type: Number,\n    \"default\": 0\n  },\n  accountLocked: {\n    type: Boolean,\n    \"default\": false\n  },\n  lockUntil: {\n    type: Date\n  },\n  lastFailedLogin: {\n    type: Date\n  }\n});\n\n// Add method to check if user can request new OTP\nuserSchema.methods.canRequestOTP = function () {\n  if (!this.lastOTPAttempt) return true;\n\n  // Allow new OTP request after 1 minute\n  var timeSinceLastAttempt = Date.now() - this.lastOTPAttempt;\n  return timeSinceLastAttempt >= 60000; // 1 minute in milliseconds\n};\n\n// Add method to handle failed login attempts\nuserSchema.methods.handleFailedLogin = /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n  return _regeneratorRuntime().wrap(function _callee$(_context) {\n    while (1) switch (_context.prev = _context.next) {\n      case 0:\n        this.failedLoginAttempts += 1;\n        this.lastFailedLogin = new Date();\n\n        // Lock account after 5 failed attempts\n        if (this.failedLoginAttempts >= 5) {\n          this.accountLocked = true;\n          this.lockUntil = new Date(Date.now() + 30 * 60 * 1000); // Lock for 30 minutes\n        }\n        _context.next = 5;\n        return this.save();\n      case 5:\n      case \"end\":\n        return _context.stop();\n    }\n  }, _callee, this);\n}));\n\n// Add method to reset failed login attempts\nuserSchema.methods.resetFailedLoginAttempts = /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n  return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n    while (1) switch (_context2.prev = _context2.next) {\n      case 0:\n        this.failedLoginAttempts = 0;\n        this.accountLocked = false;\n        this.lockUntil = null;\n        _context2.next = 5;\n        return this.save();\n      case 5:\n      case \"end\":\n        return _context2.stop();\n    }\n  }, _callee2, this);\n}));\nvar user = mongoose.model('user', userSchema);\nmodule.exports = user;\n\n//# sourceURL=webpack://drive/./models/user.model.js?");

/***/ }),

/***/ "./routes/admin.routes.js":
/*!********************************!*\
  !*** ./routes/admin.routes.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("var express = __webpack_require__(/*! express */ \"express\");\nvar router = express.Router();\nvar auth = __webpack_require__(/*! ../middleware/auth */ \"./middleware/auth.js\");\nvar _require = __webpack_require__(/*! ../controllers/adminController */ \"./controllers/adminController.js\"),\n  isAdmin = _require.isAdmin;\nvar adminController = __webpack_require__(/*! ../controllers/adminController */ \"./controllers/adminController.js\");\n\n// All admin routes should be protected by both auth and isAdmin middleware\nrouter.use(auth);\nrouter.use(isAdmin);\n\n// Stats and overview\nrouter.get('/stats', adminController.getStats);\nrouter.get('/submissions/stats', adminController.getSubmissionStats);\n\n// Submissions management\nrouter.get('/submissions', adminController.getSubmissions);\nrouter.get('/submissions/pending', adminController.getPendingSubmissions);\nrouter.get('/submissions/:id', adminController.getSubmissionById);\nrouter.patch('/submissions/:id/status', adminController.updateSubmissionStatus);\nrouter.post('/submissions/:id/review', adminController.reviewSubmission);\n\n// Products management\nrouter.get('/products', adminController.getProducts);\nrouter.patch('/products/:id/status', adminController.updateProductStatus);\n\n// Users management\nrouter.get('/users', adminController.getUsers);\nrouter.patch('/users/:id/status', adminController.updateUserStatus);\nmodule.exports = router;\n\n//# sourceURL=webpack://drive/./routes/admin.routes.js?");

/***/ }),

/***/ "./routes/index.routes.js":
/*!********************************!*\
  !*** ./routes/index.routes.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("var express = __webpack_require__(/*! express */ \"express\");\nvar router = express.Router();\nrouter.get('/home', function (req, res) {\n  res.render('home');\n});\nmodule.exports = router;\n\n//# sourceURL=webpack://drive/./routes/index.routes.js?");

/***/ }),

/***/ "./routes/productRoutes.js":
/*!*********************************!*\
  !*** ./routes/productRoutes.js ***!
  \*********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar express = __webpack_require__(/*! express */ \"express\");\nvar fs = (__webpack_require__(/*! fs */ \"fs\").promises);\nvar _require = __webpack_require__(/*! ../controllers/productController */ \"./controllers/productController.js\"),\n  searchProducts = _require.searchProducts,\n  getFeaturedProducts = _require.getFeaturedProducts,\n  getHealthierAlternatives = _require.getHealthierAlternatives,\n  getIndianProducts = _require.getIndianProducts;\nvar _require2 = __webpack_require__(/*! ../middleware/upload */ \"./middleware/upload.js\"),\n  uploadProductImages = _require2.uploadProductImages,\n  handleUploadError = _require2.handleUploadError;\nvar auth = __webpack_require__(/*! ../middleware/auth */ \"./middleware/auth.js\");\nvar ProductSubmission = __webpack_require__(/*! ../models/ProductSubmission */ \"./models/ProductSubmission.js\");\nvar _require3 = __webpack_require__(/*! ../middleware/errorMiddleware */ \"./middleware/errorMiddleware.js\"),\n  catchAsync = _require3.catchAsync;\nvar _require4 = __webpack_require__(/*! ../utils/errorHandler */ \"./utils/errorHandler.js\"),\n  AppError = _require4.AppError,\n  ErrorCodes = _require4.ErrorCodes;\nvar router = express.Router();\n\n// Public routes\nrouter.get('/search', searchProducts);\nrouter.get('/featured', getFeaturedProducts);\nrouter.get('/indian', getIndianProducts);\nrouter.post('/alternatives', getHealthierAlternatives); // Fixed route path to avoid double products prefix\n\n// Protected routes\nrouter.post('/submit', auth, uploadProductImages, handleUploadError, catchAsync(/*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(req, res) {\n    var _req$files, _req$files2;\n    var productImage, barcodeImage, submission;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (!(!((_req$files = req.files) !== null && _req$files !== void 0 && (_req$files = _req$files.productImage) !== null && _req$files !== void 0 && _req$files[0]) || !((_req$files2 = req.files) !== null && _req$files2 !== void 0 && (_req$files2 = _req$files2.barcodeImage) !== null && _req$files2 !== void 0 && _req$files2[0]))) {\n            _context.next = 5;\n            break;\n          }\n          if (!req.files) {\n            _context.next = 4;\n            break;\n          }\n          _context.next = 4;\n          return Promise.all(Object.values(req.files).flat().map(function (file) {\n            return fs.unlink(file.path)[\"catch\"](console.error);\n          }));\n        case 4:\n          throw new AppError('Both product and barcode images are required', 400, ErrorCodes.VALIDATION_ERROR);\n        case 5:\n          productImage = req.files.productImage[0].path;\n          barcodeImage = req.files.barcodeImage[0].path; // Validate required fields\n          if (!(!req.body.productName || !req.body.barcodeNumber)) {\n            _context.next = 11;\n            break;\n          }\n          _context.next = 10;\n          return Promise.all([fs.unlink(productImage)[\"catch\"](console.error), fs.unlink(barcodeImage)[\"catch\"](console.error)]);\n        case 10:\n          throw new AppError('Product name and barcode number are required', 400, ErrorCodes.VALIDATION_ERROR);\n        case 11:\n          _context.next = 13;\n          return ProductSubmission.create({\n            productName: req.body.productName,\n            barcodeNumber: req.body.barcodeNumber,\n            productImage: productImage,\n            barcodeImage: barcodeImage,\n            additionalInfo: req.body.additionalInfo,\n            submittedBy: req.user._id,\n            status: 'pending'\n          });\n        case 13:\n          submission = _context.sent;\n          res.status(201).json({\n            success: true,\n            message: 'Product submitted successfully',\n            data: {\n              submission: submission\n            }\n          });\n        case 15:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function (_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}()));\nmodule.exports = router;\n\n//# sourceURL=webpack://drive/./routes/productRoutes.js?");

/***/ }),

/***/ "./routes/user.routes.js":
/*!*******************************!*\
  !*** ./routes/user.routes.js ***!
  \*******************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar express = __webpack_require__(/*! express */ \"express\");\nvar app = express();\nvar router = express.Router();\nvar userModel = __webpack_require__(/*! ../models/user.model */ \"./models/user.model.js\");\nvar bcrypt = __webpack_require__(/*! bcrypt */ \"bcrypt\");\nvar jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nvar _require = __webpack_require__(/*! express-validator */ \"express-validator\"),\n  body = _require.body,\n  validationResult = _require.validationResult;\nvar auth = __webpack_require__(/*! ../middleware/auth */ \"./middleware/auth.js\");\nvar _require2 = __webpack_require__(/*! ../config/email */ \"./config/email.js\"),\n  sendEmail = _require2.sendEmail;\nvar rateLimit = __webpack_require__(/*! express-rate-limit */ \"express-rate-limit\");\nvar sanitizer = __webpack_require__(/*! express-sanitizer */ \"express-sanitizer\");\n\n// Enhanced password hashing configuration\nvar PEPPER = process.env.PASSWORD_PEPPER || 'your-secure-pepper-key'; // Move to env in production\nvar SALT_ROUNDS = 12;\nvar hashPassword = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(password) {\n    var pepperedPassword, salt;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          // Add pepper to password before hashing\n          pepperedPassword = password + PEPPER;\n          _context.next = 4;\n          return bcrypt.genSalt(SALT_ROUNDS);\n        case 4:\n          salt = _context.sent;\n          _context.next = 7;\n          return bcrypt.hash(pepperedPassword, salt);\n        case 7:\n          return _context.abrupt(\"return\", _context.sent);\n        case 10:\n          _context.prev = 10;\n          _context.t0 = _context[\"catch\"](0);\n          throw new Error('Password hashing failed');\n        case 13:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee, null, [[0, 10]]);\n  }));\n  return function hashPassword(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar verifyPassword = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(password, hash) {\n    var pepperedPassword;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          pepperedPassword = password + PEPPER;\n          _context2.next = 4;\n          return bcrypt.compare(pepperedPassword, hash);\n        case 4:\n          return _context2.abrupt(\"return\", _context2.sent);\n        case 7:\n          _context2.prev = 7;\n          _context2.t0 = _context2[\"catch\"](0);\n          throw new Error('Password verification failed');\n        case 10:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2, null, [[0, 7]]);\n  }));\n  return function verifyPassword(_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\n// Rate limiters\nvar loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  // 15 minutes\n  max: 5,\n  // 5 attempts per window per IP\n  message: 'Too many login attempts, please try again after 15 minutes',\n  standardHeaders: true,\n  legacyHeaders: false,\n  handler: function handler(req, res) {\n    res.status(429).json({\n      message: 'Too many login attempts, please try again after 15 minutes',\n      retryAfter: Math.ceil(req.rateLimit.resetTime / 1000)\n    });\n  },\n  skipSuccessfulRequests: true // Don't count successful logins\n});\nvar signupLimiter = rateLimit({\n  windowMs: 60 * 60 * 1000,\n  // 1 hour\n  max: 3,\n  // 3 accounts per hour per IP\n  message: 'Too many accounts created, please try again after an hour'\n});\nvar forgotPasswordLimiter = rateLimit({\n  windowMs: 60 * 60 * 1000,\n  // 1 hour\n  max: 3,\n  // 3 password reset attempts per hour\n  message: 'Too many password reset attempts, please try again after an hour'\n});\n\n// Middleware\nrouter.use(sanitizer());\n\n// Helper function to validate password strength\nvar validatePasswordStrength = function validatePasswordStrength(password) {\n  var minLength = 8;\n  var hasUpperCase = /[A-Z]/.test(password);\n  var hasLowerCase = /[a-z]/.test(password);\n  var hasNumbers = /\\d/.test(password);\n  var hasNonAlphas = /\\W/.test(password);\n  if (password.length < minLength) return 'Password must be at least 8 characters long';\n  if (!hasUpperCase) return 'Password must contain at least one uppercase letter';\n  if (!hasLowerCase) return 'Password must contain at least one lowercase letter';\n  if (!hasNumbers) return 'Password must contain at least one number';\n  if (!hasNonAlphas) return 'Password must contain at least one special character';\n  return null;\n};\nrouter.get('/signup', function (req, res) {\n  res.render('register');\n});\n// Signup route with enhanced security\nrouter.post('/signup', signupLimiter, body('username').trim().isLength({\n  min: 3\n}).withMessage('Username must be at least 3 characters long').matches(/^[a-zA-Z0-9_-]+$/).withMessage('Username can only contain letters, numbers, underscores and dashes').escape(), body('email').trim().isEmail().withMessage('Invalid email address').normalizeEmail(), body('password').trim().custom(function (value) {\n  var validationError = validatePasswordStrength(value);\n  if (validationError) throw new Error(validationError);\n  return true;\n}), /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(req, res) {\n    var errors, _req$body, email, username, password, role, sanitizedUsername, sanitizedEmail, existingUser, hashedPassword, newUser, token, userResponse;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          errors = validationResult(req);\n          if (errors.isEmpty()) {\n            _context3.next = 4;\n            break;\n          }\n          return _context3.abrupt(\"return\", res.status(400).json({\n            errors: errors.array(),\n            message: 'User registration failed'\n          }));\n        case 4:\n          _req$body = req.body, email = _req$body.email, username = _req$body.username, password = _req$body.password, role = _req$body.role; // Sanitize inputs\n          sanitizedUsername = req.sanitize(username.toLowerCase());\n          sanitizedEmail = req.sanitize(email.toLowerCase()); // Check existing user\n          _context3.next = 9;\n          return userModel.findOne({\n            $or: [{\n              username: sanitizedUsername\n            }, {\n              email: sanitizedEmail\n            }]\n          });\n        case 9:\n          existingUser = _context3.sent;\n          if (!existingUser) {\n            _context3.next = 12;\n            break;\n          }\n          return _context3.abrupt(\"return\", res.status(400).json({\n            message: existingUser.username === sanitizedUsername ? 'Username already exists' : 'Email already registered'\n          }));\n        case 12:\n          _context3.next = 14;\n          return hashPassword(password);\n        case 14:\n          hashedPassword = _context3.sent;\n          _context3.next = 17;\n          return userModel.create({\n            username: sanitizedUsername,\n            email: sanitizedEmail,\n            password: hashedPassword,\n            role: role === 'admin' ? 'admin' : 'user'\n          });\n        case 17:\n          newUser = _context3.sent;\n          // Generate JWT token with reduced payload\n          token = jwt.sign({\n            uid: newUser._id,\n            role: newUser.role\n          }, process.env.JWT_SECRET, {\n            expiresIn: '1h',\n            algorithm: 'HS256'\n          }); // Remove sensitive data from response\n          userResponse = {\n            _id: newUser._id,\n            username: newUser.username,\n            email: newUser.email,\n            role: newUser.role\n          };\n          res.status(201).json({\n            message: 'Registration successful',\n            user: userResponse,\n            token: token\n          });\n          _context3.next = 27;\n          break;\n        case 23:\n          _context3.prev = 23;\n          _context3.t0 = _context3[\"catch\"](0);\n          console.error('Signup error:', _context3.t0);\n          res.status(500).json({\n            message: 'Registration failed',\n            error: _context3.t0.message\n          });\n        case 27:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 23]]);\n  }));\n  return function (_x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}());\nrouter.get('/login', function (req, res) {\n  res.render('login');\n});\n// Login route with enhanced security\nrouter.post('/login', loginLimiter, body('username').trim().isLength({\n  min: 3\n}).escape(), body('password').trim().isLength({\n  min: 8\n}), /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(req, res) {\n    var errors, _req$body2, username, password, sanitizedUsername, user, waitMinutes, isMatch, token, userResponse;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.prev = 0;\n          errors = validationResult(req);\n          if (errors.isEmpty()) {\n            _context4.next = 4;\n            break;\n          }\n          return _context4.abrupt(\"return\", res.status(400).json({\n            message: 'Invalid credentials'\n          }));\n        case 4:\n          _req$body2 = req.body, username = _req$body2.username, password = _req$body2.password;\n          sanitizedUsername = req.sanitize(username.toLowerCase());\n          _context4.next = 8;\n          return userModel.findOne({\n            username: sanitizedUsername\n          });\n        case 8:\n          user = _context4.sent;\n          if (!(user && user.accountLocked && user.lockUntil > Date.now())) {\n            _context4.next = 12;\n            break;\n          }\n          waitMinutes = Math.ceil((user.lockUntil - Date.now()) / (60 * 1000));\n          return _context4.abrupt(\"return\", res.status(423).json({\n            message: \"Account is temporarily locked. Please try again in \".concat(waitMinutes, \" minutes\")\n          }));\n        case 12:\n          if (user) {\n            _context4.next = 16;\n            break;\n          }\n          _context4.next = 15;\n          return bcrypt.compare(password, '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LcdYste0X/S.PXY1G');\n        case 15:\n          return _context4.abrupt(\"return\", res.status(401).json({\n            message: 'Invalid credentials'\n          }));\n        case 16:\n          _context4.next = 18;\n          return verifyPassword(password, user.password);\n        case 18:\n          isMatch = _context4.sent;\n          if (isMatch) {\n            _context4.next = 23;\n            break;\n          }\n          _context4.next = 22;\n          return user.handleFailedLogin();\n        case 22:\n          return _context4.abrupt(\"return\", res.status(401).json({\n            message: user.accountLocked ? 'Account has been locked due to too many failed attempts' : 'Invalid credentials'\n          }));\n        case 23:\n          _context4.next = 25;\n          return user.resetFailedLoginAttempts();\n        case 25:\n          user.lastLogin = new Date();\n          _context4.next = 28;\n          return user.save();\n        case 28:\n          // Generate new JWT token\n          token = jwt.sign({\n            uid: user._id,\n            role: user.role\n          }, process.env.JWT_SECRET, {\n            expiresIn: '1h',\n            algorithm: 'HS256'\n          });\n          userResponse = {\n            _id: user._id,\n            username: user.username,\n            email: user.email,\n            role: user.role\n          };\n          res.status(200).json({\n            message: 'Login successful',\n            user: userResponse,\n            token: token\n          });\n          _context4.next = 37;\n          break;\n        case 33:\n          _context4.prev = 33;\n          _context4.t0 = _context4[\"catch\"](0);\n          console.error('Login error:', _context4.t0);\n          res.status(500).json({\n            message: 'Login failed',\n            error: 'An unexpected error occurred'\n          });\n        case 37:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4, null, [[0, 33]]);\n  }));\n  return function (_x6, _x7) {\n    return _ref4.apply(this, arguments);\n  };\n}());\n\n// Generate OTP\nfunction generateOTP() {\n  return Math.floor(100000 + Math.random() * 900000).toString();\n}\n\n// Forgot Password - Request OTP\nrouter.post('/forgot-password', body('email').isEmail().normalizeEmail(), /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(req, res) {\n    var errors, email, user, otp, emailSent;\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.prev = 0;\n          errors = validationResult(req);\n          if (errors.isEmpty()) {\n            _context5.next = 4;\n            break;\n          }\n          return _context5.abrupt(\"return\", res.status(400).json({\n            message: 'Invalid email format'\n          }));\n        case 4:\n          email = req.body.email;\n          _context5.next = 7;\n          return userModel.findOne({\n            email: email.toLowerCase()\n          });\n        case 7:\n          user = _context5.sent;\n          if (user) {\n            _context5.next = 10;\n            break;\n          }\n          return _context5.abrupt(\"return\", res.status(404).json({\n            message: 'No account found with this email address'\n          }));\n        case 10:\n          if (user.canRequestOTP()) {\n            _context5.next = 12;\n            break;\n          }\n          return _context5.abrupt(\"return\", res.status(429).json({\n            message: 'Please wait 1 minute before requesting another OTP'\n          }));\n        case 12:\n          // Generate and save OTP\n          otp = generateOTP();\n          user.resetOTP = otp;\n          user.otpExpiry = Date.now() + 600000; // 10 minutes\n          user.lastOTPAttempt = Date.now();\n          user.otpAttempts += 1;\n          _context5.next = 19;\n          return user.save();\n        case 19:\n          _context5.next = 21;\n          return sendEmail(email, 'Password Reset OTP', \"\\n        <h2>Password Reset Request</h2>\\n        <p>Your OTP for password reset is: <strong>\".concat(otp, \"</strong></p>\\n        <p>This OTP will expire in 10 minutes.</p>\\n        <p>If you didn't request this password reset, please ignore this email.</p>\\n        \"));\n        case 21:\n          emailSent = _context5.sent;\n          if (emailSent) {\n            _context5.next = 24;\n            break;\n          }\n          throw new Error('Failed to send OTP email');\n        case 24:\n          res.json({\n            message: 'OTP sent successfully to your email'\n          });\n          _context5.next = 31;\n          break;\n        case 27:\n          _context5.prev = 27;\n          _context5.t0 = _context5[\"catch\"](0);\n          console.error('Password reset error:', _context5.t0);\n          res.status(500).json({\n            message: _context5.t0.message || 'Error sending OTP'\n          });\n        case 31:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee5, null, [[0, 27]]);\n  }));\n  return function (_x8, _x9) {\n    return _ref5.apply(this, arguments);\n  };\n}());\n\n// Verify OTP\nrouter.post('/verify-otp', body('email').isEmail().normalizeEmail(), body('otp').isLength({\n  min: 6,\n  max: 6\n}), /*#__PURE__*/function () {\n  var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(req, res) {\n    var errors, _req$body3, email, otp, user;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.prev = 0;\n          errors = validationResult(req);\n          if (errors.isEmpty()) {\n            _context6.next = 4;\n            break;\n          }\n          return _context6.abrupt(\"return\", res.status(400).json({\n            message: 'Invalid input'\n          }));\n        case 4:\n          _req$body3 = req.body, email = _req$body3.email, otp = _req$body3.otp;\n          _context6.next = 7;\n          return userModel.findOne({\n            email: email.toLowerCase(),\n            resetOTP: otp,\n            otpExpiry: {\n              $gt: Date.now()\n            }\n          });\n        case 7:\n          user = _context6.sent;\n          if (user) {\n            _context6.next = 10;\n            break;\n          }\n          return _context6.abrupt(\"return\", res.status(400).json({\n            message: 'Invalid or expired OTP'\n          }));\n        case 10:\n          res.json({\n            message: 'OTP verified successfully'\n          });\n          _context6.next = 17;\n          break;\n        case 13:\n          _context6.prev = 13;\n          _context6.t0 = _context6[\"catch\"](0);\n          console.error('OTP verification error:', _context6.t0);\n          res.status(500).json({\n            message: 'Error verifying OTP'\n          });\n        case 17:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6, null, [[0, 13]]);\n  }));\n  return function (_x0, _x1) {\n    return _ref6.apply(this, arguments);\n  };\n}());\n\n// Reset Password with OTP\nrouter.post('/reset-password', body('email').isEmail().normalizeEmail(), body('otp').isLength({\n  min: 6,\n  max: 6\n}), body('password').isLength({\n  min: 5\n}).trim(), /*#__PURE__*/function () {\n  var _ref7 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(req, res) {\n    var errors, _req$body4, email, otp, password, user, hashedPassword;\n    return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n      while (1) switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.prev = 0;\n          errors = validationResult(req);\n          if (errors.isEmpty()) {\n            _context7.next = 4;\n            break;\n          }\n          return _context7.abrupt(\"return\", res.status(400).json({\n            message: 'Invalid input'\n          }));\n        case 4:\n          _req$body4 = req.body, email = _req$body4.email, otp = _req$body4.otp, password = _req$body4.password;\n          _context7.next = 7;\n          return userModel.findOne({\n            email: email.toLowerCase(),\n            resetOTP: otp,\n            otpExpiry: {\n              $gt: Date.now()\n            }\n          });\n        case 7:\n          user = _context7.sent;\n          if (user) {\n            _context7.next = 10;\n            break;\n          }\n          return _context7.abrupt(\"return\", res.status(400).json({\n            message: 'Invalid or expired OTP'\n          }));\n        case 10:\n          _context7.next = 12;\n          return bcrypt.hash(password, 10);\n        case 12:\n          hashedPassword = _context7.sent;\n          user.password = hashedPassword;\n          user.resetOTP = undefined;\n          user.otpExpiry = undefined;\n          user.otpAttempts = 0;\n          _context7.next = 19;\n          return user.save();\n        case 19:\n          res.json({\n            message: 'Password reset successful'\n          });\n          _context7.next = 26;\n          break;\n        case 22:\n          _context7.prev = 22;\n          _context7.t0 = _context7[\"catch\"](0);\n          console.error('Password reset error:', _context7.t0);\n          res.status(500).json({\n            message: 'Error resetting password'\n          });\n        case 26:\n        case \"end\":\n          return _context7.stop();\n      }\n    }, _callee7, null, [[0, 22]]);\n  }));\n  return function (_x10, _x11) {\n    return _ref7.apply(this, arguments);\n  };\n}());\n\n// Change Password (requires authentication)\nrouter.post('/change-password', auth, body('currentPassword').notEmpty(), body('newPassword').isLength({\n  min: 5\n}), /*#__PURE__*/function () {\n  var _ref8 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(req, res) {\n    var _req$body5, currentPassword, newPassword, isMatch, hashedPassword;\n    return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n      while (1) switch (_context8.prev = _context8.next) {\n        case 0:\n          _context8.prev = 0;\n          _req$body5 = req.body, currentPassword = _req$body5.currentPassword, newPassword = _req$body5.newPassword; // Check current password\n          _context8.next = 4;\n          return bcrypt.compare(currentPassword, req.user.password);\n        case 4:\n          isMatch = _context8.sent;\n          if (isMatch) {\n            _context8.next = 7;\n            break;\n          }\n          return _context8.abrupt(\"return\", res.status(400).json({\n            message: 'Current password is incorrect'\n          }));\n        case 7:\n          _context8.next = 9;\n          return bcrypt.hash(newPassword, 10);\n        case 9:\n          hashedPassword = _context8.sent;\n          req.user.password = hashedPassword;\n          _context8.next = 13;\n          return req.user.save();\n        case 13:\n          res.json({\n            message: 'Password changed successfully'\n          });\n          _context8.next = 19;\n          break;\n        case 16:\n          _context8.prev = 16;\n          _context8.t0 = _context8[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error changing password',\n            error: _context8.t0.message\n          });\n        case 19:\n        case \"end\":\n          return _context8.stop();\n      }\n    }, _callee8, null, [[0, 16]]);\n  }));\n  return function (_x12, _x13) {\n    return _ref8.apply(this, arguments);\n  };\n}());\n\n// Update user preferences\nrouter.patch('/preferences', auth, /*#__PURE__*/function () {\n  var _ref9 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(req, res) {\n    var _req$body6, dietaryPreferences, allergies, location, user, userResponse;\n    return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n      while (1) switch (_context9.prev = _context9.next) {\n        case 0:\n          _context9.prev = 0;\n          _req$body6 = req.body, dietaryPreferences = _req$body6.dietaryPreferences, allergies = _req$body6.allergies, location = _req$body6.location;\n          _context9.next = 4;\n          return userModel.findById(req.user._id);\n        case 4:\n          user = _context9.sent;\n          if (user) {\n            _context9.next = 7;\n            break;\n          }\n          return _context9.abrupt(\"return\", res.status(404).json({\n            message: 'User not found'\n          }));\n        case 7:\n          if (dietaryPreferences !== undefined) {\n            user.dietaryPreferences = dietaryPreferences;\n          }\n          if (allergies !== undefined) {\n            user.allergies = allergies;\n          }\n          if (location !== undefined) {\n            user.location = location;\n          }\n          _context9.next = 12;\n          return user.save();\n        case 12:\n          // Return updated user without password\n          userResponse = {\n            _id: user._id,\n            username: user.username,\n            email: user.email,\n            role: user.role,\n            dietaryPreferences: user.dietaryPreferences,\n            allergies: user.allergies,\n            location: user.location\n          };\n          res.json({\n            message: 'Preferences updated successfully',\n            user: userResponse\n          });\n          _context9.next = 19;\n          break;\n        case 16:\n          _context9.prev = 16;\n          _context9.t0 = _context9[\"catch\"](0);\n          res.status(500).json({\n            message: 'Error updating preferences',\n            error: _context9.t0.message\n          });\n        case 19:\n        case \"end\":\n          return _context9.stop();\n      }\n    }, _callee9, null, [[0, 16]]);\n  }));\n  return function (_x14, _x15) {\n    return _ref9.apply(this, arguments);\n  };\n}());\nmodule.exports = router;\n\n//# sourceURL=webpack://drive/./routes/user.routes.js?");

/***/ }),

/***/ "./utils/cacheService.js":
/*!*******************************!*\
  !*** ./utils/cacheService.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

eval("function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar CACHE_CONFIG = {\n  healthRating: 24 * 60 * 60 * 1000 // 24 hours\n};\nvar CacheService = /*#__PURE__*/function () {\n  function CacheService() {\n    _classCallCheck(this, CacheService);\n    this.cache = new Map();\n    this.timeouts = new Map();\n    this.maxSize = 5000; // Larger cache size for backend\n  }\n  return _createClass(CacheService, [{\n    key: \"generateKey\",\n    value: function generateKey(method) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      try {\n        var sanitizedMethod = String(method).replace(/[^a-zA-Z0-9_]/g, '');\n        var sanitizedParams = this._sanitizeParams(params);\n        return \"\".concat(sanitizedMethod, \":\").concat(JSON.stringify(sanitizedParams));\n      } catch (error) {\n        console.error('Error generating cache key:', error);\n        return null;\n      }\n    }\n  }, {\n    key: \"get\",\n    value: function get(key) {\n      if (!key) return null;\n      var item = this.cache.get(key);\n      if (!item) return null;\n      var now = Date.now();\n      if (now > item.expiry) {\n        this[\"delete\"](key);\n        return null;\n      }\n      item.lastAccessed = now;\n      return item.data;\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, data) {\n      var _this = this;\n      var ttl = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 300000;\n      if (!key) return;\n      if (this.cache.size >= this.maxSize) {\n        this._evictLRU();\n      }\n      var expiry = Date.now() + ttl;\n      this.cache.set(key, {\n        data: data,\n        expiry: expiry,\n        lastAccessed: Date.now()\n      });\n      if (this.timeouts.has(key)) {\n        clearTimeout(this.timeouts.get(key));\n      }\n      var timeout = setTimeout(function () {\n        return _this[\"delete\"](key);\n      }, ttl);\n      this.timeouts.set(key, timeout);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(key) {\n      if (!key) return;\n      this.cache[\"delete\"](key);\n      if (this.timeouts.has(key)) {\n        clearTimeout(this.timeouts.get(key));\n        this.timeouts[\"delete\"](key);\n      }\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.cache.clear();\n      this.timeouts.forEach(function (timeout) {\n        return clearTimeout(timeout);\n      });\n      this.timeouts.clear();\n    }\n  }, {\n    key: \"getStats\",\n    value: function getStats() {\n      var _this2 = this;\n      var now = Date.now();\n      var stats = {\n        totalEntries: this.cache.size,\n        activeEntries: 0,\n        expiredEntries: 0,\n        averageAge: 0,\n        memoryUsage: process.memoryUsage().heapUsed\n      };\n      var totalAge = 0;\n      this.cache.forEach(function (value, key) {\n        var age = now - value.lastAccessed;\n        if (now <= value.expiry) {\n          stats.activeEntries++;\n          totalAge += age;\n        } else {\n          stats.expiredEntries++;\n          _this2[\"delete\"](key);\n        }\n      });\n      if (stats.activeEntries > 0) {\n        stats.averageAge = totalAge / stats.activeEntries;\n      }\n      return stats;\n    }\n  }, {\n    key: \"_sanitizeParams\",\n    value: function _sanitizeParams(params) {\n      if (_typeof(params) !== 'object' || params === null) {\n        return {};\n      }\n      var sanitized = {};\n      for (var _i = 0, _Object$entries = Object.entries(params); _i < _Object$entries.length; _i++) {\n        var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n          key = _Object$entries$_i[0],\n          value = _Object$entries$_i[1];\n        var sanitizedKey = String(key).replace(/[^a-zA-Z0-9_]/g, '');\n        if (_typeof(value) === 'object' && value !== null) {\n          sanitized[sanitizedKey] = this._sanitizeParams(value);\n        } else if (typeof value === 'string') {\n          sanitized[sanitizedKey] = value.replace(/[^\\w\\s-]/g, '');\n        } else if (typeof value === 'number' || typeof value === 'boolean') {\n          sanitized[sanitizedKey] = value;\n        }\n      }\n      return sanitized;\n    }\n  }, {\n    key: \"_evictLRU\",\n    value: function _evictLRU() {\n      var _this3 = this;\n      var entries = _toConsumableArray(this.cache.entries()).sort(function (a, b) {\n        return a[1].lastAccessed - b[1].lastAccessed;\n      });\n      var toRemove = Math.max(1, Math.floor(this.maxSize * 0.2));\n      entries.slice(0, toRemove).forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 1),\n          key = _ref2[0];\n        return _this3[\"delete\"](key);\n      });\n    }\n  }]);\n}(); // Create singleton instance\nvar cacheService = new CacheService();\n\n// Health Rating specific cache implementation\nvar HealthRatingCache = /*#__PURE__*/function () {\n  function HealthRatingCache() {\n    _classCallCheck(this, HealthRatingCache);\n    this._cache = cacheService;\n  }\n  return _createClass(HealthRatingCache, [{\n    key: \"getKey\",\n    value: function getKey(product) {\n      if (!product || !product._id) return null;\n      return this._cache.generateKey('healthRating', {\n        id: product._id,\n        name: product.name,\n        category: product.category,\n        nutriments: product.nutriments,\n        ingredients: product.ingredients,\n        nutriscore_grade: product.nutriscore_grade\n      });\n    }\n  }, {\n    key: \"get\",\n    value: function get(product) {\n      var key = this.getKey(product);\n      return this._cache.get(key);\n    }\n  }, {\n    key: \"set\",\n    value: function set(product, result) {\n      var key = this.getKey(product);\n      this._cache.set(key, result, CACHE_CONFIG.healthRating);\n    }\n  }, {\n    key: \"invalidate\",\n    value: function invalidate(product) {\n      var key = this.getKey(product);\n      this._cache[\"delete\"](key);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var _this4 = this;\n      var healthRatingKeys = _toConsumableArray(this._cache.cache.keys()).filter(function (key) {\n        return key.startsWith('healthRating:');\n      });\n      healthRatingKeys.forEach(function (key) {\n        return _this4._cache[\"delete\"](key);\n      });\n    }\n  }, {\n    key: \"getStats\",\n    value: function getStats() {\n      return this._cache.getStats();\n    }\n  }]);\n}(); // Export cache instance\nexports.HealthRatingCache = new HealthRatingCache();\n\n//# sourceURL=webpack://drive/./utils/cacheService.js?");

/***/ }),

/***/ "./utils/errorHandler.js":
/*!*******************************!*\
  !*** ./utils/errorHandler.js ***!
  \*******************************/
/***/ ((module) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(t, e) { if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e; if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\"); return _assertThisInitialized(t); }\nfunction _assertThisInitialized(e) { if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); return e; }\nfunction _inherits(t, e) { if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\"); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), Object.defineProperty(t, \"prototype\", { writable: !1 }), e && _setPrototypeOf(t, e); }\nfunction _wrapNativeSuper(t) { var r = \"function\" == typeof Map ? new Map() : void 0; return _wrapNativeSuper = function _wrapNativeSuper(t) { if (null === t || !_isNativeFunction(t)) return t; if (\"function\" != typeof t) throw new TypeError(\"Super expression must either be null or a function\"); if (void 0 !== r) { if (r.has(t)) return r.get(t); r.set(t, Wrapper); } function Wrapper() { return _construct(t, arguments, _getPrototypeOf(this).constructor); } return Wrapper.prototype = Object.create(t.prototype, { constructor: { value: Wrapper, enumerable: !1, writable: !0, configurable: !0 } }), _setPrototypeOf(Wrapper, t); }, _wrapNativeSuper(t); }\nfunction _construct(t, e, r) { if (_isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments); var o = [null]; o.push.apply(o, e); var p = new (t.bind.apply(t, o))(); return r && _setPrototypeOf(p, r.prototype), p; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _isNativeFunction(t) { try { return -1 !== Function.toString.call(t).indexOf(\"[native code]\"); } catch (n) { return \"function\" == typeof t; } }\nfunction _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }\nfunction _getPrototypeOf(t) { return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) { return t.__proto__ || Object.getPrototypeOf(t); }, _getPrototypeOf(t); }\nvar AppError = /*#__PURE__*/function (_Error) {\n  function AppError(message) {\n    var _this;\n    var statusCode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n    var errorCode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'INTERNAL_SERVER_ERROR';\n    _classCallCheck(this, AppError);\n    _this = _callSuper(this, AppError, [message]);\n    _this.statusCode = statusCode;\n    _this.errorCode = errorCode;\n    _this.status = \"\".concat(statusCode).startsWith('4') ? 'fail' : 'error';\n    Error.captureStackTrace(_this, _this.constructor);\n    return _this;\n  }\n  _inherits(AppError, _Error);\n  return _createClass(AppError);\n}(/*#__PURE__*/_wrapNativeSuper(Error)); // Predefined error codes for consistency\nvar ErrorCodes = {\n  VALIDATION_ERROR: 'VALIDATION_ERROR',\n  UNAUTHORIZED: 'UNAUTHORIZED',\n  NOT_FOUND: 'NOT_FOUND',\n  FORBIDDEN: 'FORBIDDEN',\n  CONFLICT: 'CONFLICT',\n  RATE_LIMIT: 'RATE_LIMIT',\n  INTERNAL_ERROR: 'INTERNAL_SERVER_ERROR',\n  BAD_REQUEST: 'BAD_REQUEST',\n  INVALID_TOKEN: 'INVALID_TOKEN'\n};\nvar formatValidationErrors = function formatValidationErrors(errors) {\n  return Object.values(errors).map(function (err) {\n    return {\n      field: err.path,\n      message: err.message,\n      value: err.value\n    };\n  });\n};\nvar errorResponse = function errorResponse(err) {\n  var includeStack = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var response = {\n    status: err.status || 'error',\n    errorCode: err.errorCode || ErrorCodes.INTERNAL_ERROR,\n    message: err.message || 'An unexpected error occurred',\n    timestamp: new Date().toISOString()\n  };\n  if (err.details) {\n    response.details = err.details;\n  }\n  if (err.errors && Object.keys(err.errors).length > 0) {\n    response.validationErrors = formatValidationErrors(err.errors);\n  }\n  if (includeStack && \"development\" === 'development') {\n    response.stack = err.stack;\n  }\n  return response;\n};\nmodule.exports = {\n  AppError: AppError,\n  ErrorCodes: ErrorCodes,\n  errorResponse: errorResponse,\n  formatValidationErrors: formatValidationErrors\n};\n\n//# sourceURL=webpack://drive/./utils/errorHandler.js?");

/***/ }),

/***/ "./utils/healthRating.js":
/*!*******************************!*\
  !*** ./utils/healthRating.js ***!
  \*******************************/
/***/ ((module) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nvar INGREDIENT_ANALYSIS = {\n  artificial_colors: {\n    ingredients: ['E102', 'E104', 'E110', 'E122', 'E124', 'E129', 'tartrazine', 'quinoline yellow', 'sunset yellow', 'carmoisine', 'ponceau', 'allura red'],\n    weight: -0.5,\n    reason: 'Artificial colors may cause hyperactivity in children'\n  },\n  artificial_sweeteners: {\n    ingredients: ['aspartame', 'sucralose', 'acesulfame', 'saccharin', 'E951', 'E950', 'E952', 'E954', 'E955', 'E962'],\n    weight: -0.3,\n    reason: 'Artificial sweeteners may affect gut bacteria and metabolism'\n  },\n  preservatives: {\n    ingredients: ['E211', 'E212', 'E220', 'sodium benzoate', 'potassium sorbate', 'sulfur dioxide', 'nitrite', 'nitrate', 'BHA', 'BHT'],\n    weight: -0.4,\n    reason: 'Some preservatives may have negative health effects'\n  },\n  healthy_nutrients: {\n    ingredients: ['whole grain', 'quinoa', 'chia', 'flax', 'oat', 'spinach', 'kale', 'broccoli', 'almonds', 'walnuts'],\n    weight: 0.5,\n    reason: 'Contains beneficial nutrients and fiber'\n  },\n  processed_grains: {\n    ingredients: ['refined flour', 'maida', 'corn flour', 'rice flour', 'wheat flour', 'enriched flour', 'bleached flour', 'modified starch'],\n    weight: -0.3,\n    reason: 'Refined grains have lower nutritional value compared to whole grains'\n  },\n  snack_additives: {\n    ingredients: ['msg', 'monosodium glutamate', 'maltodextrin', 'hydrolyzed', 'flavor enhancer', 'artificial flavor', 'natural flavor', 'E621', 'E631', 'E627'],\n    weight: -0.4,\n    reason: 'Contains flavor enhancers and additives common in processed snacks'\n  },\n  processed_oils: {\n    ingredients: ['palm oil', 'hydrogenated', 'partially hydrogenated', 'vegetable oil', 'interesterified', 'shortening'],\n    weight: -0.4,\n    reason: 'Contains processed oils that may have trans fats or inflammatory properties'\n  },\n  healthy_grains: {\n    ingredients: ['whole wheat', 'whole grain', 'multigrain', 'ragi', 'millet', 'quinoa', 'oats', 'barley', 'brown rice'],\n    weight: 0.4,\n    reason: 'Contains whole grains with higher nutritional value'\n  },\n  spices_herbs: {\n    ingredients: ['turmeric', 'ginger', 'garlic', 'black pepper', 'cumin', 'coriander', 'cardamom', 'cinnamon', 'basil'],\n    weight: 0.3,\n    reason: 'Contains natural spices with potential health benefits'\n  },\n  healthy_proteins: {\n    ingredients: ['whey protein', 'soy protein', 'pea protein', 'egg white', 'milk protein', 'casein', 'protein isolate', 'quinoa protein'],\n    weight: 0.4,\n    reason: 'Contains quality protein sources'\n  },\n  healthy_fats: {\n    ingredients: ['olive oil', 'avocado oil', 'coconut oil', 'peanut', 'almond', 'cashew', 'sunflower seeds', 'pumpkin seeds', 'chia seeds'],\n    weight: 0.3,\n    reason: 'Contains healthy fats and omega fatty acids'\n  },\n  fortified_nutrients: {\n    ingredients: ['vitamin d', 'vitamin b12', 'folate', 'iron', 'calcium', 'zinc', 'magnesium', 'potassium', 'dha', 'epa'],\n    weight: 0.3,\n    reason: 'Fortified with essential nutrients'\n  },\n  probiotics: {\n    ingredients: ['lactobacillus', 'bifidobacterium', 'probiotics', 'live cultures', 'fermented', 'cultured', 'yogurt cultures'],\n    weight: 0.3,\n    reason: 'Contains beneficial probiotics'\n  },\n  dairy_positive: {\n    ingredients: ['milk', 'whole milk', 'skimmed milk', 'low fat milk', 'toned milk', 'a2 milk', 'organic milk', 'pasteurized milk', 'homogenized milk', 'fresh milk', 'buffalo milk', 'cow milk', 'goat milk'],\n    weight: 0.5,\n    reason: 'Contains natural dairy milk with essential nutrients'\n  },\n  dairy_additives: {\n    ingredients: ['milk solids', 'milk powder', 'reconstituted milk', 'ultra filtered', 'milk protein concentrate'],\n    weight: -0.2,\n    reason: 'Contains processed dairy ingredients'\n  },\n  dairy_enrichment: {\n    ingredients: ['vitamin d3', 'vitamin d', 'calcium fortified', 'omega 3', 'dha', 'vitamin a', 'vitamin b12', 'folate'],\n    weight: 0.3,\n    reason: 'Fortified with essential nutrients'\n  },\n  whole_grains: {\n    ingredients: ['rolled oats', 'whole oats', 'steel cut oats', 'quick oats', 'instant oats', 'whole grain', 'whole wheat', 'brown rice', 'quinoa', 'buckwheat'],\n    weight: 2.0,\n    // Highest positive weight for whole grains\n    reason: 'Whole grains provide excellent nutritional value with fiber, protein, and minerals'\n  },\n  single_ingredient_wholefood: {\n    ingredients: ['oats', 'rolled oats', 'steel cut oats',\n    // Adding oats specifically\n    'almonds', 'cashews', 'peanuts', 'brown rice', 'quinoa', 'chia seeds'],\n    weight: 1.5,\n    reason: 'Single-ingredient whole foods are minimally processed and highly nutritious'\n  }\n};\nvar PRODUCT_CATEGORIES = {\n  beverages: {\n    keywords: ['drink', 'beverage', 'juice', 'smoothie', 'shake', 'tea', 'coffee', 'water'],\n    nutritionalFocus: ['sugar', 'caffeine', 'artificial_sweeteners'],\n    scoreAdjustment: 0.9 // Slightly stricter scoring for beverages\n  },\n  spreads: {\n    keywords: ['butter', 'spread', 'paste', 'jam', 'margarine', 'nutella'],\n    nutritionalFocus: ['fats', 'sugar', 'protein'],\n    scoreAdjustment: 1.0\n  },\n  dairy: {\n    keywords: ['milk', 'yogurt', 'cheese', 'curd', 'cream', 'dairy', 'dahi', 'buttermilk', 'lassi'],\n    nutritionalFocus: ['protein', 'calcium', 'vitamin_d', 'fats'],\n    scoreAdjustment: 1.2 // Increased from 1.1 to better reflect dairy nutritional value\n  },\n  protein_supplements: {\n    keywords: ['protein', 'supplement', 'whey', 'mass gainer', 'protein powder'],\n    nutritionalFocus: ['protein', 'vitamins', 'minerals'],\n    scoreAdjustment: 1.2\n  },\n  breakfast_cereals: {\n    keywords: ['cereal', 'muesli', 'granola', 'oats', 'porridge'],\n    nutritionalFocus: ['fiber', 'sugar', 'whole_grains'],\n    scoreAdjustment: 1.2,\n    // Increased from 1.0 to better reflect whole grain value\n    wholeGrainBonus: 0.5 // Additional bonus for whole grain products\n  }\n};\nvar NUTRITIONAL_GUIDELINES = {\n  proteins_100g: {\n    low: 5,\n    high: 20,\n    weight: 0.4,\n    isPositive: true\n  },\n  fiber_100g: {\n    low: 3,\n    high: 6,\n    weight: 0.4,\n    isPositive: true\n  },\n  sugars_100g: {\n    low: 5,\n    high: 22.5,\n    weight: -0.5,\n    isPositive: false\n  },\n  saturated_fat_100g: {\n    low: 1.5,\n    high: 5,\n    weight: -0.4,\n    isPositive: false\n  },\n  salt_100g: {\n    low: 0.3,\n    high: 1.5,\n    weight: -0.3,\n    isPositive: false\n  },\n  trans_fat_100g: {\n    low: 0.1,\n    high: 0.5,\n    weight: -0.6,\n    isPositive: false\n  },\n  sodium_100g: {\n    low: 120,\n    high: 500,\n    weight: -0.4,\n    isPositive: false\n  },\n  calcium_100g: {\n    low: 100,\n    high: 200,\n    weight: 0.5,\n    isPositive: true\n  },\n  vitamin_d_100g: {\n    low: 0.75,\n    high: 1.5,\n    weight: 0.4,\n    isPositive: true\n  },\n  potassium_100g: {\n    low: 300,\n    high: 600,\n    weight: 0.3,\n    isPositive: true\n  },\n  calories_100g: {\n    low: 50,\n    high: 300,\n    weight: -0.3,\n    isPositive: false\n  }\n};\nfunction analyzeNutrients(nutriments) {\n  var score = 3;\n  var analysis = [];\n  Object.entries(NUTRITIONAL_GUIDELINES).forEach(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      nutrient = _ref2[0],\n      guidelines = _ref2[1];\n    var value = parseFloat(nutriments[nutrient]) || 0;\n    if (guidelines.isPositive) {\n      if (value >= guidelines.high) {\n        score += guidelines.weight;\n        analysis.push(\"High in \".concat(nutrient.replace('_100g', ''), \": Good source\"));\n      } else if (value <= guidelines.low) {\n        score -= guidelines.weight / 2;\n        analysis.push(\"Low in \".concat(nutrient.replace('_100g', ''), \": Could be better\"));\n      }\n    } else {\n      if (value >= guidelines.high) {\n        score += guidelines.weight; // negative weight\n        analysis.push(\"High in \".concat(nutrient.replace('_100g', ''), \": Consider reducing\"));\n      } else if (value <= guidelines.low) {\n        score -= guidelines.weight; // negative weight becomes positive\n        analysis.push(\"Low in \".concat(nutrient.replace('_100g', ''), \": Good\"));\n      }\n    }\n  });\n  return {\n    score: score,\n    analysis: analysis\n  };\n}\nfunction analyzeIngredients(ingredientsList) {\n  var score = 0;\n  var analysis = [];\n  var ingredients = ingredientsList.toLowerCase();\n  Object.entries(INGREDIENT_ANALYSIS).forEach(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n      category = _ref4[0],\n      data = _ref4[1];\n    var found = false;\n    data.ingredients.forEach(function (ingredient) {\n      if (ingredients.includes(ingredient.toLowerCase())) {\n        found = true;\n        score += data.weight;\n        analysis.push(\"Contains \".concat(ingredient, \": \").concat(data.reason));\n      }\n    });\n  });\n  return {\n    score: score,\n    analysis: analysis\n  };\n}\nvar SNACK_CATEGORIES = ['snacks', 'chips', 'crisps', 'crackers', 'cookies', 'biscuits', 'namkeen', 'kurkure', 'extruded snacks'];\nfunction detectProductCategory(product) {\n  if (!product.name && !product.category) return null;\n  var productText = \"\".concat(product.name, \" \").concat(product.category).toLowerCase();\n  for (var _i = 0, _Object$entries = Object.entries(PRODUCT_CATEGORIES); _i < _Object$entries.length; _i++) {\n    var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n      category = _Object$entries$_i[0],\n      data = _Object$entries$_i[1];\n    if (data.keywords.some(function (keyword) {\n      return productText.includes(keyword);\n    })) {\n      return _objectSpread({\n        category: category\n      }, data);\n    }\n  }\n  return null;\n}\nvar calculateHealthScore = function calculateHealthScore(product) {\n  var score = 3.0; // Default score\n  var adjustments = [];\n\n  // Special handling for single-ingredient whole grain products\n  var ingredients = Array.isArray(product.ingredients) ? product.ingredients.join(' ').toLowerCase() : (product.ingredients || '').toLowerCase();\n\n  // Check if it's a single ingredient whole grain product\n  if (ingredients.includes('oats') || ingredients.includes('rolled oats')) {\n    var ingredientList = ingredients.split(',').map(function (i) {\n      return i.trim();\n    });\n\n    // If it's only oats (allowing for minimal additions like \"rolled oats\" or \"whole grain oats\")\n    if (ingredientList.length <= 2 && ingredientList.every(function (i) {\n      return i.includes('oat');\n    })) {\n      score = 5.0; // Highest score for pure oats products\n      adjustments.push({\n        reason: 'Single-ingredient whole grain product with excellent nutritional profile',\n        impact: 2.0\n      });\n      return {\n        score: score,\n        adjustments: adjustments\n      };\n    }\n  }\n\n  // Continue with regular scoring for other products\n  // ...existing scoring logic...\n};\nfunction calculateHealthRating(product) {\n  try {\n    if (!product) return {\n      score: 3,\n      analysis: ['No product data available']\n    };\n    var finalScore = 3;\n    var analysis = [];\n\n    // Special handling for single-ingredient whole grain products\n    if (product.ingredients) {\n      var ingredients = typeof product.ingredients === 'string' ? product.ingredients.toLowerCase() : Array.isArray(product.ingredients) ? product.ingredients.join(',').toLowerCase() : '';\n      var ingredientList = ingredients.split(',').map(function (i) {\n        return i.trim();\n      });\n\n      // Check if it's a single ingredient oat product\n      if (ingredientList.length <= 2 && ingredientList.every(function (i) {\n        return i.includes('oat');\n      })) {\n        return {\n          score: 5.0,\n          analysis: ['Single-ingredient whole grain product - Excellent nutritional profile'],\n          rating: 'Excellent Choice',\n          color: 'green',\n          pros: ['Pure whole grain oats with excellent nutritional value'],\n          cons: []\n        };\n      }\n    }\n\n    // Detect product category for specialized analysis\n    var productCategory = detectProductCategory(product);\n    var categoryMultiplier = (productCategory === null || productCategory === void 0 ? void 0 : productCategory.scoreAdjustment) || 1;\n\n    // Start with Nutri-Score if available\n    if (product.nutriscore_grade) {\n      var nutriScoreValues = {\n        'a': 5,\n        'b': 4,\n        'c': 3,\n        'd': 2,\n        'e': 1\n      };\n      finalScore = nutriScoreValues[product.nutriscore_grade.toLowerCase()] || 3;\n      analysis.push(\"Nutri-Score \".concat(product.nutriscore_grade.toUpperCase()));\n    }\n\n    // Analyze nutrients with category-specific focus\n    if (product.nutriments) {\n      var _analyzeNutrients = analyzeNutrients(product.nutriments),\n        nutrientScore = _analyzeNutrients.score,\n        nutrientAnalysis = _analyzeNutrients.analysis;\n      if (productCategory) {\n        var focusNutrients = productCategory.nutritionalFocus;\n        var relevantAnalysis = nutrientAnalysis.filter(function (a) {\n          return focusNutrients.some(function (nutrient) {\n            return a.toLowerCase().includes(nutrient);\n          });\n        });\n        analysis = [].concat(_toConsumableArray(analysis), _toConsumableArray(relevantAnalysis));\n      } else {\n        analysis = [].concat(_toConsumableArray(analysis), _toConsumableArray(nutrientAnalysis));\n      }\n\n      // Weight nutrient score more heavily (60%)\n      finalScore = finalScore * 0.4 + nutrientScore * 0.6;\n    }\n\n    // Analyze ingredients\n    if (product.ingredients) {\n      var _analyzeIngredients = analyzeIngredients(product.ingredients),\n        ingredientScore = _analyzeIngredients.score,\n        ingredientAnalysis = _analyzeIngredients.analysis;\n      // Weight ingredient analysis (40%)\n      finalScore = finalScore * 0.6 + ingredientScore * 0.4;\n      analysis = [].concat(_toConsumableArray(analysis), _toConsumableArray(ingredientAnalysis));\n    }\n\n    // Apply category-specific adjustments\n    finalScore *= categoryMultiplier;\n\n    // Add category-specific analysis\n    if (productCategory) {\n      analysis.push(\"Analyzed as \".concat(productCategory.category.replace('_', ' '), \" product\"));\n    }\n\n    // Ensure score stays within 1-5 range and round to 1 decimal\n    finalScore = Math.max(1, Math.min(5, Math.round(finalScore * 10) / 10));\n\n    // Enhanced analysis to separate pros and cons\n    var healthAnalysis = analysis.map(function (item) {\n      if (item.includes('Good source') || item.includes('Low in') || item.includes('beneficial')) {\n        return {\n          type: 'pro',\n          text: item\n        };\n      }\n      return {\n        type: 'con',\n        text: item\n      };\n    });\n    return {\n      score: finalScore,\n      analysis: analysis,\n      rating: finalScore >= 4 ? 'Healthy Choice' : finalScore >= 3 ? 'Moderately Healthy' : finalScore >= 2 ? 'Less Healthy' : 'Not Recommended',\n      color: finalScore >= 4 ? 'green' : finalScore >= 3 ? 'yellow' : finalScore >= 2 ? 'orange' : 'red',\n      pros: healthAnalysis.filter(function (a) {\n        return a.type === 'pro';\n      }).map(function (a) {\n        return a.text;\n      }),\n      cons: healthAnalysis.filter(function (a) {\n        return a.type === 'con';\n      }).map(function (a) {\n        return a.text;\n      })\n    };\n  } catch (error) {\n    console.error('Error calculating health rating:', error);\n    return {\n      score: 3,\n      analysis: ['Error analyzing product'],\n      rating: 'Analysis Failed',\n      color: 'gray'\n    };\n  }\n}\nmodule.exports = calculateHealthRating;\n\n//# sourceURL=webpack://drive/./utils/healthRating.js?");

/***/ }),

/***/ "./utils/token-service.js":
/*!********************************!*\
  !*** ./utils/token-service.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return r; }; var t, r = {}, e = Object.prototype, n = e.hasOwnProperty, o = \"function\" == typeof Symbol ? Symbol : {}, i = o.iterator || \"@@iterator\", a = o.asyncIterator || \"@@asyncIterator\", u = o.toStringTag || \"@@toStringTag\"; function c(t, r, e, n) { return Object.defineProperty(t, r, { value: e, enumerable: !n, configurable: !n, writable: !n }); } try { c({}, \"\"); } catch (t) { c = function c(t, r, e) { return t[r] = e; }; } function h(r, e, n, o) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype); return c(a, \"_invoke\", function (r, e, n) { var o = 1; return function (i, a) { if (3 === o) throw Error(\"Generator is already running\"); if (4 === o) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var u = n.delegate; if (u) { var c = d(u, n); if (c) { if (c === f) continue; return c; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (1 === o) throw o = 4, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = 3; var h = s(r, e, n); if (\"normal\" === h.type) { if (o = n.done ? 4 : 2, h.arg === f) continue; return { value: h.arg, done: n.done }; } \"throw\" === h.type && (o = 4, n.method = \"throw\", n.arg = h.arg); } }; }(r, n, new Context(o || [])), !0), a; } function s(t, r, e) { try { return { type: \"normal\", arg: t.call(r, e) }; } catch (t) { return { type: \"throw\", arg: t }; } } r.wrap = h; var f = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var l = {}; c(l, i, function () { return this; }); var p = Object.getPrototypeOf, y = p && p(p(x([]))); y && y !== e && n.call(y, i) && (l = y); var v = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(l); function g(t) { [\"next\", \"throw\", \"return\"].forEach(function (r) { c(t, r, function (t) { return this._invoke(r, t); }); }); } function AsyncIterator(t, r) { function e(o, i, a, u) { var c = s(t[o], t, i); if (\"throw\" !== c.type) { var h = c.arg, f = h.value; return f && \"object\" == _typeof(f) && n.call(f, \"__await\") ? r.resolve(f.__await).then(function (t) { e(\"next\", t, a, u); }, function (t) { e(\"throw\", t, a, u); }) : r.resolve(f).then(function (t) { h.value = t, a(h); }, function (t) { return e(\"throw\", t, a, u); }); } u(c.arg); } var o; c(this, \"_invoke\", function (t, n) { function i() { return new r(function (r, o) { e(t, n, r, o); }); } return o = o ? o.then(i, i) : i(); }, !0); } function d(r, e) { var n = e.method, o = r.i[n]; if (o === t) return e.delegate = null, \"throw\" === n && r.i[\"return\"] && (e.method = \"return\", e.arg = t, d(r, e), \"throw\" === e.method) || \"return\" !== n && (e.method = \"throw\", e.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), f; var i = s(o, r.i, e.arg); if (\"throw\" === i.type) return e.method = \"throw\", e.arg = i.arg, e.delegate = null, f; var a = i.arg; return a ? a.done ? (e[r.r] = a.value, e.next = r.n, \"return\" !== e.method && (e.method = \"next\", e.arg = t), e.delegate = null, f) : a : (e.method = \"throw\", e.arg = new TypeError(\"iterator result is not an object\"), e.delegate = null, f); } function w(t) { this.tryEntries.push(t); } function m(r) { var e = r[4] || {}; e.type = \"normal\", e.arg = t, r[4] = e; } function Context(t) { this.tryEntries = [[-1]], t.forEach(w, this), this.reset(!0); } function x(r) { if (null != r) { var e = r[i]; if (e) return e.call(r); if (\"function\" == typeof r.next) return r; if (!isNaN(r.length)) { var o = -1, a = function e() { for (; ++o < r.length;) if (n.call(r, o)) return e.value = r[o], e.done = !1, e; return e.value = t, e.done = !0, e; }; return a.next = a; } } throw new TypeError(_typeof(r) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, c(v, \"constructor\", GeneratorFunctionPrototype), c(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = c(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), r.isGeneratorFunction = function (t) { var r = \"function\" == typeof t && t.constructor; return !!r && (r === GeneratorFunction || \"GeneratorFunction\" === (r.displayName || r.name)); }, r.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, c(t, u, \"GeneratorFunction\")), t.prototype = Object.create(v), t; }, r.awrap = function (t) { return { __await: t }; }, g(AsyncIterator.prototype), c(AsyncIterator.prototype, a, function () { return this; }), r.AsyncIterator = AsyncIterator, r.async = function (t, e, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(h(t, e, n, o), i); return r.isGeneratorFunction(e) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, g(v), c(v, u, \"Generator\"), c(v, i, function () { return this; }), c(v, \"toString\", function () { return \"[object Generator]\"; }), r.keys = function (t) { var r = Object(t), e = []; for (var n in r) e.unshift(n); return function t() { for (; e.length;) if ((n = e.pop()) in r) return t.value = n, t.done = !1, t; return t.done = !0, t; }; }, r.values = x, Context.prototype = { constructor: Context, reset: function reset(r) { if (this.prev = this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(m), !r) for (var e in this) \"t\" === e.charAt(0) && n.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0][4]; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(r) { if (this.done) throw r; var e = this; function n(t) { a.type = \"throw\", a.arg = r, e.next = t; } for (var o = e.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i[4], u = this.prev, c = i[1], h = i[2]; if (-1 === i[0]) return n(\"end\"), !1; if (!c && !h) throw Error(\"try statement without catch or finally\"); if (null != i[0] && i[0] <= u) { if (u < c) return this.method = \"next\", this.arg = t, n(c), !0; if (u < h) return n(h), !1; } } }, abrupt: function abrupt(t, r) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n[0] > -1 && n[0] <= this.prev && this.prev < n[2]) { var o = n; break; } } o && (\"break\" === t || \"continue\" === t) && o[0] <= r && r <= o[2] && (o = null); var i = o ? o[4] : {}; return i.type = t, i.arg = r, o ? (this.method = \"next\", this.next = o[2], f) : this.complete(i); }, complete: function complete(t, r) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && r && (this.next = r), f; }, finish: function finish(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[2] === t) return this.complete(e[4], e[3]), m(e), f; } }, \"catch\": function _catch(t) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var e = this.tryEntries[r]; if (e[0] === t) { var n = e[4]; if (\"throw\" === n.type) { var o = n.arg; m(e); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(r, e, n) { return this.delegate = { i: x(r), r: e, n: n }, \"next\" === this.method && (this.arg = t), f; } }, r; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\nvar jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nvar RefreshToken = __webpack_require__(/*! ../models/refresh-token.model */ \"./models/refresh-token.model.js\");\nvar crypto = __webpack_require__(/*! crypto */ \"crypto\");\nvar generateTokens = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user, ipAddress, userAgent) {\n    var accessToken, refreshToken, expiresAt;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          // Generate access token with shorter expiry\n          accessToken = jwt.sign({\n            uid: user._id,\n            role: user.role\n          }, process.env.JWT_SECRET, {\n            expiresIn: '15m',\n            // Shorter expiry for access tokens\n            algorithm: 'HS256'\n          }); // Generate refresh token\n          refreshToken = crypto.randomBytes(40).toString('hex');\n          expiresAt = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000); // 30 days\n          // Save refresh token to database\n          _context.next = 5;\n          return RefreshToken.create({\n            userId: user._id,\n            token: refreshToken,\n            expiresAt: expiresAt,\n            userAgent: userAgent,\n            ipAddress: ipAddress\n          });\n        case 5:\n          return _context.abrupt(\"return\", {\n            accessToken: accessToken,\n            refreshToken: refreshToken,\n            expiresIn: 900 // 15 minutes in seconds\n          });\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return function generateTokens(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar verifyRefreshToken = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(token) {\n    var refreshToken;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return RefreshToken.findOne({\n            token: token,\n            isRevoked: false,\n            expiresAt: {\n              $gt: new Date()\n            }\n          }).populate('userId');\n        case 2:\n          refreshToken = _context2.sent;\n          if (refreshToken) {\n            _context2.next = 5;\n            break;\n          }\n          throw new Error('Invalid refresh token');\n        case 5:\n          return _context2.abrupt(\"return\", refreshToken);\n        case 6:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return function verifyRefreshToken(_x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar revokeRefreshToken = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(token) {\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return RefreshToken.updateOne({\n            token: token\n          }, {\n            isRevoked: true\n          });\n        case 2:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3);\n  }));\n  return function revokeRefreshToken(_x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nmodule.exports = {\n  generateTokens: generateTokens,\n  verifyRefreshToken: verifyRefreshToken,\n  revokeRefreshToken: revokeRefreshToken\n};\n\n//# sourceURL=webpack://drive/./utils/token-service.js?");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("axios");

/***/ }),

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("bcrypt");

/***/ }),

/***/ "cookie-parser":
/*!********************************!*\
  !*** external "cookie-parser" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("cookie-parser");

/***/ }),

/***/ "cors":
/*!***********************!*\
  !*** external "cors" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("cors");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("dotenv");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("express");

/***/ }),

/***/ "express-rate-limit":
/*!*************************************!*\
  !*** external "express-rate-limit" ***!
  \*************************************/
/***/ ((module) => {

"use strict";
module.exports = require("express-rate-limit");

/***/ }),

/***/ "express-sanitizer":
/*!************************************!*\
  !*** external "express-sanitizer" ***!
  \************************************/
/***/ ((module) => {

"use strict";
module.exports = require("express-sanitizer");

/***/ }),

/***/ "express-validator":
/*!************************************!*\
  !*** external "express-validator" ***!
  \************************************/
/***/ ((module) => {

"use strict";
module.exports = require("express-validator");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "helmet":
/*!*************************!*\
  !*** external "helmet" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("helmet");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

"use strict";
module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("mongoose");

/***/ }),

/***/ "multer":
/*!*************************!*\
  !*** external "multer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("multer");

/***/ }),

/***/ "nodemailer":
/*!*****************************!*\
  !*** external "nodemailer" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = require("nodemailer");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "xss":
/*!**********************!*\
  !*** external "xss" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("xss");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./app.js");
/******/ 	
/******/ })()
;